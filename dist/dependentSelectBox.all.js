!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DependentSelectBox",[],t):"object"==typeof exports?exports.DependentSelectBox=t():e.DependentSelectBox=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c}));var r="data-disallow-submit-when-disabled",i="data-dependent-data-link",o="data-has-dependent-listener",a="data-parents",s="data-dependent-select-box",l="dependentSelectBoxLoaded",u="dependentSelectBoxLoading",c="["+s+"]"},function(e,t,n){"use strict";var r=n(0),i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=function(e){var t=Number(e);return Number.isNaN(t)?e:t},a=function(e){var t,n,o=e.form,a=e.getAttribute(r.a);if(o&&null!==a)try{for(var s=i(o.elements),l=s.next();!l.done;l=s.next()){var u=l.value;u!==e&&(u.disabled=e.disabled&&"submit"===u.type)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(e){if(function(e){return"checkbox"===e.type?e.name.includes("[]"):"radio"===e.type||Boolean(e.multiple)}(e))return function(e){var t,n,r,a,s=[];if(e instanceof HTMLSelectElement)try{for(var l=i(e.selectedOptions),u=l.next();!u.done;u=l.next()){var c=u.value;s.push(o(c.value))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}if(["checkbox","radio"].includes(e.type)){var d=document.querySelectorAll('input[name="'+e.name+'"]');try{for(var f=i(d),p=f.next();!p.done;p=f.next()){var h=p.value;h.checked&&s.push(o(h.value))}}catch(e){r={error:e}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(r)throw r.error}}}return s.length?s:null}(e);if("checkbox"===e.type)return e.checked;var t=e.value.trim();return"textarea"===e.type?t:""===t?null:o(t)},u=function(e){var t=e.getAttribute(r.c);return t?JSON.parse(t):[]},c=function(e,t){var n,r,i={};try{for(var o=s(t),a=o.next();!a.done;a=o.next()){var u=a.value,c=e.elements.namedItem(u);c&&(i[c.name]=l(c))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},d=function(e){return null!==e.getAttribute(r.d)},f=function(e){return e.setAttribute(r.d,"true")},p=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},h=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=function(e){var t=this;this.handleResponse=function(e,n,i){for(var o in i){var s=document.getElementById(o);s.disabled=i[o].disabled,s.innerHTML=i[o].options,a(s)}var l=new CustomEvent(r.f,{detail:{form:e,dependentSelectBoxes:n,response:i}});t.naja.dispatchEvent(l)},this.handleRequest=function(e,n,i){return p(t,void 0,Promise,(function(){var t,o,a;return h(this,(function(s){switch(s.label){case 0:if(!(t=e.getAttribute(r.b)))throw new Error('Form "'+e.id+'" must have "data-dependent-data-link" attribute!');return o=new CustomEvent(r.g,{detail:{form:e,dependentSelectBoxes:n,request:i}}),this.naja.dispatchEvent(o),[4,this.naja.makeRequest("POST",t,JSON.stringify(i),{fetch:{headers:{"Content-Type":"application/json"}},history:!1})];case 1:return a=s.sent(),this.handleResponse(e,n,a),[2]}}))}))},this.naja=e},v=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},y=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},m=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e},g=function(e,t,n,r){var i,o,a,s,l=[];try{for(var d=v(n),f=d.next();!f.done;f=d.next()){var p=f.value;r.includes(p.id)||l.push(p.id);try{for(var h=(a=void 0,v(u(p))),b=h.next();!b.done;b=h.next()){var y=b.value;l.includes(y)||l.push(y)}}catch(e){a={error:e}}finally{try{b&&!b.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}}}catch(e){i={error:e}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}var g=c(e,m(r,l));return{trigger:t.id,values:g}},w=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},E=function(e){var t=this;this.addListeners=function(e,n,r){var i=["change"];t.isParentTextBased(e)&&i.push("keydown"),i.forEach((function(i){return e.addEventListener(i,t.handleChange(n,r))})),f(e)},this.findParent=function(e){return document.getElementById(e)},this.findSelectBoxes=function(){return Array.from(document.querySelectorAll(r.h))},this.handleChange=function(e,n){return function(r){var i,o,a=r.target,s=a.form;try{for(var l=w(n),c=l.next();!c.done;c=l.next()){var d=c.value,f=u(d);d.disabled=f.includes(a.id)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}var p=t.getFormSelectBoxes(s,n);t.requestManager.handleRequest(s,p,g(s,a,p,e))}},this.getFormSelectBoxes=function(e,t){return t.filter((function(t){return t.form===e}))},this.isParentTextBased=function(e){return["text","number","textarea"].includes(e.type)},this.requestManager=new b(e)},j=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},x=function(){var e=this;this.initialize=function(t){e.domManager=new E(t),t.addEventListener("init",e.load),t.addEventListener("complete",e.load),t.snippetHandler.addEventListener("afterUpdate",e.load)},this.load=function(){var t,n,r=e.domManager.findSelectBoxes();try{for(var i=j(r),o=i.next();!o.done;o=i.next()){var s=o.value,l=u(s);l.forEach(e.initParent(l,r)),a(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},this.initParent=function(t,n){return function(r){var i=e.domManager.findParent(r);null===i||d(i)||e.domManager.addListeners(i,t,n)}}};t.a=x},function(e,t,n){"use strict";(function(e){var r=n(3),i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function c(e){var t=s();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=d(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}var p=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){var t=this;if(e.type in this.listeners){for(var n=function(n){setTimeout((function(){return n.call(t,e)}))},r=this.listeners[e.type],i=0,o=r.length;i<o;i++)n(r[i]);return!e.defaultPrevented}}}]),t}(),h=function(t){r(a,t);var i=c(a);function a(){var t;return e(this,a),(t=i.call(this)).listeners||p.call(l(t)),Object.defineProperty(l(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(l(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return n(a,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),f(o(a.prototype),"dispatchEvent",this).call(this,e)}}]),a}(p),b=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new h,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function v(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}function y(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,o=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!v({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:l};var l=i;(l&&!l.prototype.hasOwnProperty("signal")||s)&&((l=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r}).prototype=i.prototype);var u=n;return{fetch:function(e,t){var n=l&&l.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var i=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(r)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([i,u(e,t)])}return u(e,t)},Request:l}}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(b.prototype[Symbol.toStringTag]="AbortController",h.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(v(e))if(e.fetch){var t=y(e),n=t.fetch,r=t.Request;e.fetch=n,e.Request=r,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:b}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:h})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:i)}();try{new window.EventTarget}catch(e){window.EventTarget=r.EventTarget}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a extends EventTarget{constructor(e){super(),o(this,"selector",".ajax"),o(this,"allowedOrigins",[window.location.origin]),o(this,"handler",this.handleUI.bind(this)),this.naja=e,e.addEventListener("init",this.initialize.bind(this))}initialize(){this.bindUI(window.document.body),this.naja.snippetHandler.addEventListener("afterUpdate",(e=>{const{snippet:t}=e.detail;this.bindUI(t)}))}bindUI(e){const t=["a"+this.selector,'input[type="submit"]'+this.selector,'input[type="image"]'+this.selector,'button[type="submit"]'+this.selector,`form${this.selector} input[type="submit"]`,`form${this.selector} input[type="image"]`,`form${this.selector} button[type="submit"]`].join(", "),n=e=>{e.removeEventListener("click",this.handler),e.addEventListener("click",this.handler)},r=e.querySelectorAll(t);for(let e=0;e<r.length;e++)n(r.item(e));e.matches(t)&&n(e);const i=e=>{e.removeEventListener("submit",this.handler),e.addEventListener("submit",this.handler)};e.matches("form"+this.selector)&&i(e);const o=e.querySelectorAll("form"+this.selector);for(let e=0;e<o.length;e++)i(o.item(e))}handleUI(e){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey||e.button)return;const t=e.currentTarget,n={};"submit"===e.type?this.submitForm(t,n,e):"click"===e.type&&this.clickElement(t,n,e)}clickElement(e,t={},n){let r,i,o;if(this.dispatchEvent(new CustomEvent("interaction",{cancelable:!0,detail:{element:e,originalEvent:n,options:t}}))){if("A"===e.tagName)r="GET",i=e.href,o=null;else if("INPUT"===e.tagName||"BUTTON"===e.tagName){const{form:t}=e;if(r=e.hasAttribute("formmethod")?e.getAttribute("formmethod").toUpperCase():t.hasAttribute("method")?t.getAttribute("method").toUpperCase():"GET",i=e.getAttribute("formaction")||t.getAttribute("action")||window.location.pathname+window.location.search,o=new FormData(t),"submit"===e.type||"BUTTON"===e.tagName)o.append(e.name,e.value||"");else if("image"===e.type){const t=e.getBoundingClientRect();o.append(e.name+".x",Math.max(0,Math.floor(n.pageX-t.left))),o.append(e.name+".y",Math.max(0,Math.floor(n.pageY-t.top)))}}this.isUrlAllowed(i)&&(n&&n.preventDefault(),this.naja.makeRequest(r,i,o,t))}else n&&n.preventDefault()}submitForm(e,t={},n){if(!this.dispatchEvent(new CustomEvent("interaction",{cancelable:!0,detail:{element:e,originalEvent:n,options:t}})))return void(n&&n.preventDefault());const r=e.hasAttribute("method")?e.getAttribute("method").toUpperCase():"GET",i=e.getAttribute("action")||window.location.pathname+window.location.search,o=new FormData(e);this.isUrlAllowed(i)&&(n&&n.preventDefault(),this.naja.makeRequest(r,i,o,t))}isUrlAllowed(e){return!/^(?!https?)[^:/?#]+:/i.test(e)&&(!/^https?/i.test(e)||this.allowedOrigins.some((t=>new RegExp("^"+t,"i").test(e))))}}class s{constructor(e){o(this,"netteForms",void 0),this.naja=e,e.addEventListener("init",this.initialize.bind(this)),e.uiHandler.addEventListener("interaction",this.processForm.bind(this))}initialize(){this.initForms(window.document.body),this.naja.snippetHandler.addEventListener("afterUpdate",(e=>{const{snippet:t}=e.detail;this.initForms(t)}))}initForms(e){const t=this.netteForms||window.Nette;if(t){"form"===e.tagName&&t.initForm(e);const n=e.querySelectorAll("form");for(let e=0;e<n.length;e++)t.initForm(n.item(e))}}processForm(e){const{element:t,originalEvent:n}=e.detail;t.form&&(t.form["nette-submittedBy"]=t);const r=this.netteForms||window.Nette;"FORM"!==t.tagName&&!t.form||!r||r.validateForm(t)||(n&&(n.stopImmediatePropagation(),n.preventDefault()),e.preventDefault())}}class l extends EventTarget{constructor(e){super(),this.naja=e,e.uiHandler.addEventListener("interaction",(e=>{var t;const{element:n,options:r}=e.detail;if(n&&(n.hasAttribute("data-naja-force-redirect")||(null===(t=n.form)||void 0===t?void 0:t.hasAttribute("data-naja-force-redirect")))){var i,o;const e=null!==(i=n.getAttribute("data-naja-force-redirect"))&&void 0!==i?i:null===(o=n.form)||void 0===o?void 0:o.getAttribute("data-naja-force-redirect");r.forceRedirect="off"!==e}})),e.addEventListener("success",(e=>{const{payload:t,options:n}=e.detail;t.redirect&&(this.makeRedirect(t.redirect,n.forceRedirect,n),e.stopImmediatePropagation())})),this.locationAdapter={assign:e=>window.location.assign(e)}}makeRedirect(e,t,n={}){e instanceof URL&&(e=e.href);let r=t||!this.naja.uiHandler.isUrlAllowed(e);this.dispatchEvent(new CustomEvent("redirect",{cancelable:!0,detail:{url:e,isHardRedirect:r,setHardRedirect(e){r=!!e},options:n}}))&&(r?this.locationAdapter.assign(e):this.naja.makeRequest("GET",e,null,n))}}class u extends EventTarget{constructor(e){super(),o(this,"op",{replace:(e,t)=>{e.innerHTML=t},prepend:(e,t)=>e.insertAdjacentHTML("afterbegin",t),append:(e,t)=>e.insertAdjacentHTML("beforeend",t)}),e.addEventListener("success",(e=>{const{options:t,payload:n}=e.detail;n.snippets&&this.updateSnippets(n.snippets,!1,t)}))}updateSnippets(e,t=!1,n={}){Object.keys(e).forEach((r=>{const i=document.getElementById(r);i&&this.updateSnippet(i,e[r],t,n)}))}updateSnippet(e,t,n,r){let i=this.op.replace;!e.hasAttribute("data-naja-snippet-prepend")&&!e.hasAttribute("data-ajax-prepend")||n?!e.hasAttribute("data-naja-snippet-append")&&!e.hasAttribute("data-ajax-append")||n||(i=this.op.append):i=this.op.prepend;this.dispatchEvent(new CustomEvent("beforeUpdate",{cancelable:!0,detail:{snippet:e,content:t,fromCache:n,operation:i,changeOperation(e){i=e},options:r}}))&&("title"===e.tagName.toLowerCase()?document.title=t:i(e,t),this.dispatchEvent(new CustomEvent("afterUpdate",{cancelable:!0,detail:{snippet:e,content:t,fromCache:n,operation:i,options:r}})))}}class c{constructor(e){o(this,"href",null),o(this,"uiCache",!0),this.naja=e,e.addEventListener("init",this.initialize.bind(this)),e.addEventListener("before",this.saveUrl.bind(this)),e.addEventListener("success",this.pushNewState.bind(this)),e.uiHandler.addEventListener("interaction",this.configureMode.bind(this)),this.popStateHandler=this.handlePopState.bind(this),this.historyAdapter={replaceState:(e,t,n)=>window.history.replaceState(e,t,n),pushState:(e,t,n)=>window.history.pushState(e,t,n)}}initialize(e){const{defaultOptions:t}=e.detail;"historyUiCache"in t&&(this.uiCache=t.historyUiCache),window.addEventListener("popstate",this.popStateHandler),this.historyAdapter.replaceState(this.buildState(window.location.href,this.uiCache),window.document.title,window.location.href)}handlePopState(e){e.state&&(e.state.ui?(this.handleSnippets(e.state.ui),this.handleTitle(e.state.title)):!1===e.state.ui&&this.naja.makeRequest("GET",e.state.href,null,{history:!1,historyUiCache:!1}))}saveUrl(e){const{url:t}=e.detail;this.href=t}configureMode(e){var t,n;const{element:r,options:i}=e.detail;if(r){if(r.hasAttribute("data-naja-history")||(null===(t=r.form)||void 0===t?void 0:t.hasAttribute("data-naja-history"))){var o,a;const e=null!==(o=r.getAttribute("data-naja-history"))&&void 0!==o?o:null===(a=r.form)||void 0===a?void 0:a.getAttribute("data-naja-history");i.history=this.constructor.normalizeMode(e)}if(r.hasAttribute("data-naja-history-cache")||(null===(n=r.form)||void 0===n?void 0:n.hasAttribute("data-naja-history-nocache"))){var s,l;const e=null!==(s=r.getAttribute("data-naja-history-cache"))&&void 0!==s?s:null===(l=r.form)||void 0===l?void 0:l.getAttribute("data-naja-history-cache");i.historyUiCache="off"!==e}}}static normalizeMode(e){return"off"!==e&&!1!==e&&("replace"!==e||"replace")}pushNewState(e){const{payload:t,options:n}=e.detail,r=this.constructor.normalizeMode(n.history);if(!1===r)return;t.postGet&&t.url&&(this.href=t.url);const i="replace"===r?"replaceState":"pushState",o=!0===n.historyUiCache||!1!==n.historyUiCache&&this.uiCache;this.historyAdapter[i](this.buildState(this.href,o),window.document.title,this.href),this.href=null}buildState(e,t){const n={href:e};return t?(n.title=window.document.title,n.ui=this.findSnippets()):n.ui=!1,n}findSnippets(){const e={},t=window.document.querySelectorAll('[id^="snippet-"]');for(let n=0;n<t.length;n++){const r=t.item(n);r.hasAttribute("data-naja-history-nocache")||r.hasAttribute("data-history-nocache")||(e[r.id]=r.innerHTML)}return e}handleSnippets(e){this.naja.snippetHandler.updateSnippets(e,!0),this.naja.scriptLoader.loadScripts(e)}handleTitle(e){window.document.title=e}}class d{constructor(e){e.addEventListener("success",(e=>{const{payload:t}=e.detail;t.snippets&&this.loadScripts(t.snippets)}))}loadScripts(e){Object.keys(e).forEach((t=>{const n=e[t];if(!/<script/i.test(n))return;const r=window.document.createElement("div");r.innerHTML=n;const i=r.querySelectorAll("script");for(let e=0;e<i.length;e++){const t=i.item(e),n=window.document.createElement("script");if(n.innerHTML=t.innerHTML,t.hasAttributes()){const e=t.attributes;for(let t=0;t<e.length;t++){n[e[t].name]=e[t].value}}window.document.head.appendChild(n).parentNode.removeChild(n)}}))}}class f extends EventTarget{constructor(e,t,n,r,i,f){super(),o(this,"VERSION",2),o(this,"initialized",!1),o(this,"uiHandler",null),o(this,"redirectHandler",null),o(this,"snippetHandler",null),o(this,"formsHandler",null),o(this,"historyHandler",null),o(this,"scriptLoader",null),o(this,"extensions",[]),o(this,"defaultOptions",{}),this.uiHandler=e?new e(this):new a(this),this.redirectHandler=t?new t(this):new l(this),this.snippetHandler=n?new n(this):new u(this),this.formsHandler=r?new r(this):new s(this),this.historyHandler=i?new i(this):new c(this),this.scriptLoader=f?new f(this):new d(this)}registerExtension(e){this.initialized&&e.initialize(this),this.extensions.push(e)}initialize(e={}){if(this.initialized)throw new Error("Cannot initialize Naja, it is already initialized.");this.defaultOptions=e,this.extensions.forEach((e=>e.initialize(this))),this.dispatchEvent(new CustomEvent("init",{detail:{defaultOptions:e}})),this.initialized=!0}async makeRequest(e,t,n=null,r={}){if(t instanceof URL&&(t=t.href),r={...this.defaultOptions,...r,fetch:{...this.defaultOptions.fetch||{},...r.fetch||{}}},"GET"===e.toUpperCase()&&n instanceof FormData){const e=new URL(t,location.href);for(const[t,r]of n)e.searchParams.append(t,r);t=e.toString(),n=null}const i=new AbortController,o=new Request(t,{credentials:"same-origin",...r.fetch,method:e,headers:new Headers(r.fetch.headers||{}),body:null!==n&&Object.getPrototypeOf(n)===Object.prototype?new URLSearchParams(n):n,signal:i.signal});if(o.headers.set("X-Requested-With","XMLHttpRequest"),!this.dispatchEvent(new CustomEvent("before",{cancelable:!0,detail:{request:o,method:e,url:t,data:n,options:r}})))return{};const a=window.fetch(o);let s,l;this.dispatchEvent(new CustomEvent("start",{detail:{request:o,promise:a,abortController:i,options:r}}));try{if(s=await a,!s.ok)throw new p(s);l=await s.json()}catch(e){if("AbortError"===e.name)return this.dispatchEvent(new CustomEvent("abort",{detail:{request:o,error:e,options:r}})),this.dispatchEvent(new CustomEvent("complete",{detail:{request:o,response:s,payload:void 0,error:e,options:r}})),{};throw this.dispatchEvent(new CustomEvent("error",{detail:{request:o,response:s,error:e,options:r}})),this.dispatchEvent(new CustomEvent("complete",{detail:{request:o,response:s,payload:void 0,error:e,options:r}})),e}return this.dispatchEvent(new CustomEvent("success",{detail:{request:o,response:s,payload:l,options:r}})),this.dispatchEvent(new CustomEvent("complete",{detail:{request:o,response:s,payload:l,error:void 0,options:r}})),l}}class p extends Error{constructor(e){const t=`HTTP ${e.status}: ${e.statusText}`;super(t),this.name=this.constructor.name,this.stack=new Error(t).stack,this.response=e}}const h=new f;h.registerExtension(new class{constructor(){o(this,"abortable",!0),o(this,"abortController",null)}initialize(e){e.uiHandler.addEventListener("interaction",this.checkAbortable.bind(this)),e.addEventListener("init",this.onInitialize.bind(this)),e.addEventListener("before",this.checkAbortable.bind(this)),e.addEventListener("start",this.saveAbortController.bind(this)),e.addEventListener("complete",this.clearAbortController.bind(this))}onInitialize(){document.addEventListener("keydown",(e=>{null!==this.abortController&&("key"in e?"Escape"===e.key:27===e.keyCode)&&!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)&&this.abortable&&(this.abortController.abort(),this.abortController=null)}))}checkAbortable(e){var t,n;const{element:r,options:i}=e.detail;this.abortable=r?"off"!==(null!==(t=r.getAttribute("data-naja-abort"))&&void 0!==t?t:null===(n=r.form)||void 0===n?void 0:n.getAttribute("data-naja-abort")):!1!==i.abort,i.abort=this.abortable}saveAbortController(e){const{abortController:t}=e.detail;this.abortController=t}clearAbortController(){this.abortController=null,this.abortable=!0}}),h.registerExtension(new class{constructor(){o(this,"abortControllers",new Map)}initialize(e){e.uiHandler.addEventListener("interaction",this.checkUniqueness.bind(this)),e.addEventListener("start",this.abortPreviousRequest.bind(this)),e.addEventListener("complete",this.clearRequest.bind(this))}checkUniqueness(e){var t,n;const{element:r,options:i}=e.detail,o=null!==(t=r.getAttribute("data-naja-unique"))&&void 0!==t?t:null===(n=r.form)||void 0===n?void 0:n.getAttribute("data-naja-unique");i.unique="off"!==o&&(null!=o?o:"default")}abortPreviousRequest(e){const{abortController:t,options:n}=e.detail;var r;!1!==n.unique&&(null===(r=this.abortControllers.get(n.unique))||void 0===r||r.abort(),this.abortControllers.set(n.unique,t))}clearRequest(e){const{request:t,options:n}=e.detail;t.signal.aborted||this.abortControllers.delete(n.unique)}}),t.a=h}).call(this,n(5))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=new WeakMap,i=new WeakMap;function o(e){const t=r.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function a(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function s(e,t){r.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=Object.keys(t);for(let e=0;e<n.length;++e){const t=n[e];t in this||Object.defineProperty(this,t,l(t))}}function l(e){return{get(){return o(this).event[e]},set(t){o(this).event[e]=t},configurable:!0,enumerable:!0}}function u(e){return{value(){const t=o(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function c(e){if(null==e||e===Object.prototype)return s;let t=i.get(e);return null==t&&(t=function(e,t){const n=Object.keys(t);if(0===n.length)return e;function r(t,n){e.call(this,t,n)}r.prototype=Object.create(e.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(let i=0;i<n.length;++i){const o=n[i];if(!(o in e.prototype)){const e="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(r.prototype,o,e?u(o):l(o))}}return r}(c(Object.getPrototypeOf(e)),e),i.set(e,t)),t}function d(e){return o(e).immediateStopped}function f(e,t){o(e).passiveListener=t}s.prototype={get type(){return o(this).event.type},get target(){return o(this).eventTarget},get currentTarget(){return o(this).currentTarget},composedPath(){const e=o(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return o(this).eventPhase},stopPropagation(){const e=o(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){const e=o(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(o(this).event.bubbles)},get cancelable(){return Boolean(o(this).event.cancelable)},preventDefault(){a(o(this))},get defaultPrevented(){return o(this).canceled},get composed(){return Boolean(o(this).event.composed)},get timeStamp(){return o(this).timeStamp},get srcElement(){return o(this).eventTarget},get cancelBubble(){return o(this).stopped},set cancelBubble(e){if(!e)return;const t=o(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)},get returnValue(){return!o(this).canceled},set returnValue(e){e||a(o(this))},initEvent(){}},Object.defineProperty(s.prototype,"constructor",{value:s,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(s.prototype,window.Event.prototype),i.set(window.Event.prototype,s));const p=new WeakMap;function h(e){return null!==e&&"object"==typeof e}function b(e){const t=p.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function v(e,t){Object.defineProperty(e,"on"+t,function(e){return{get(){let t=b(this).get(e);for(;null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set(t){"function"==typeof t||h(t)||(t=null);const n=b(this);let r=null,i=n.get(e);for(;null!=i;)3===i.listenerType?null!==r?r.next=i.next:null!==i.next?n.set(e,i.next):n.delete(e):r=i,i=i.next;if(null!==t){const i={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===r?n.set(e,i):r.next=i}},configurable:!0,enumerable:!0}}(t))}function y(e){function t(){m.call(this)}t.prototype=Object.create(m.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let n=0;n<e.length;++n)v(t.prototype,e[n]);return t}function m(){if(!(this instanceof m)){if(1===arguments.length&&Array.isArray(arguments[0]))return y(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return y(e)}throw new TypeError("Cannot call a class as a function")}p.set(this,new Map)}m.prototype={addEventListener(e,t,n){if(null==t)return;if("function"!=typeof t&&!h(t))throw new TypeError("'listener' should be a function or an object.");const r=b(this),i=h(n),o=(i?Boolean(n.capture):Boolean(n))?1:2,a={listener:t,listenerType:o,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null};let s=r.get(e);if(void 0===s)return void r.set(e,a);let l=null;for(;null!=s;){if(s.listener===t&&s.listenerType===o)return;l=s,s=s.next}l.next=a},removeEventListener(e,t,n){if(null==t)return;const r=b(this),i=(h(n)?Boolean(n.capture):Boolean(n))?1:2;let o=null,a=r.get(e);for(;null!=a;){if(a.listener===t&&a.listenerType===i)return void(null!==o?o.next=a.next:null!==a.next?r.set(e,a.next):r.delete(e));o=a,a=a.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');const t=b(this),n=e.type;let r=t.get(n);if(null==r)return!0;const i=function(e,t){return new(c(Object.getPrototypeOf(t)))(e,t)}(this,e);let a=null;for(;null!=r;){if(r.once?null!==a?a.next=r.next:null!==r.next?t.set(n,r.next):t.delete(n):a=r,f(i,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==r.listenerType&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(i);if(d(i))break;r=r.next}return f(i,null),function(e,t){o(e).eventPhase=t}(i,0),function(e,t){o(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(m.prototype,"constructor",{value:m,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(m.prototype,window.EventTarget.prototype),t.defineEventAttribute=v,t.EventTarget=m,t.default=m,e.exports=m,e.exports.EventTarget=e.exports.default=m,e.exports.defineEventAttribute=v},function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(1);r.a.registerExtension(new i.a),document.addEventListener("DOMContentLoaded",r.a.initialize.bind(r.a))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}])}));
//# sourceMappingURL=dependentSelectBox.all.js.map