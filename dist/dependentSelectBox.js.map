{"version":3,"sources":["webpack://DependentSelectBox/webpack/universalModuleDefinition","webpack://DependentSelectBox/webpack/bootstrap","webpack://DependentSelectBox/./src/assets/DependentSelectBox/constants.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/utils.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/ParentsManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/RequestManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/DataManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/DOMManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/index.ts","webpack://DependentSelectBox/./src/assets/index.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","DATA_DISALLOW_SUBMIT_WHEN_DISABLED","DATA_LINK","DATA_PARENT_LISTENER","DATA_PARENTS","DATA_SELECT_BOX","EVENT_LOADED","EVENT_LOADING","SELECT_BOX_SELECTOR","maybeGetNumberValue","number","Number","isNaN","maybeDisableSubmit","selectBox","form","disallowSubmit","getAttribute","elements","input","disabled","type","getParentValue","element","includes","Boolean","multiple","isMultiChoice","HTMLSelectElement","selectedOptions","option","push","inputs","document","querySelectorAll","checked","length","getMultiChoiceValue","trim","parentsData","JSON","parse","parents","data","parent","namedItem","setAttribute","naja","handleResponse","dependentSelectBoxes","response","id","getElementById","innerHTML","options","e","CustomEvent","detail","dispatchEvent","handleRequest","request","Promise","link","Error","this","makeRequest","dataType","history","responseType","trigger","selectBoxes","selectBoxesIds","values","ParentsManager","addListeners","events","isParentTextBased","forEach","addEventListener","handleChange","findParent","findSelectBoxes","Array","from","event","target","selectBoxParents","formSelectBoxes","getFormSelectBoxes","requestManager","DataManager","filter","initialize","domManager","load","snippetHandler","initParent","DependentSelectBox"],"mappings":"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","file":"dependentSelectBox.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"DependentSelectBox\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DependentSelectBox\"] = factory();\n\telse\n\t\troot[\"DependentSelectBox\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","export const DATA_DISALLOW_SUBMIT_WHEN_DISABLED =\n  'data-disallow-submit-when-disabled';\nexport const DATA_LINK = 'data-dependent-data-link';\nexport const DATA_PARENT_LISTENER = 'data-has-dependent-listener';\nexport const DATA_PARENTS = 'data-parents';\nexport const DATA_SELECT_BOX = 'data-dependent-select-box';\nexport const EVENT_LOADED = 'dependentSelectBoxLoaded';\nexport const EVENT_LOADING = 'dependentSelectBoxLoading';\nexport const SELECT_BOX_SELECTOR = `[${DATA_SELECT_BOX}]`;\n","import { DATA_DISALLOW_SUBMIT_WHEN_DISABLED } from './constants';\nimport { ParentValue } from './types';\n\nexport const maybeGetNumberValue = (value: string): number | string => {\n  const number = Number(value);\n  if (!Number.isNaN(number)) return number;\n  return value;\n};\n\nexport const getMultiChoiceValue = (element: HTMLInputElement): ParentValue => {\n  const value: ParentValue = [];\n  if (element instanceof HTMLSelectElement) {\n    for (const option of element.selectedOptions) {\n      value.push(maybeGetNumberValue(option.value));\n    }\n  }\n  if (['checkbox', 'radio'].includes(element.type)) {\n    const inputs = document.querySelectorAll(\n      `input[name=\"${element.name}\"]`,\n    ) as NodeListOf<HTMLInputElement>;\n    for (const input of inputs) {\n      if (input.checked) value.push(maybeGetNumberValue(input.value));\n    }\n  }\n  return value.length ? value : null;\n};\n\nexport const isMultiChoice = (element: HTMLInputElement): boolean => {\n  if (element.type === 'checkbox') {\n    return element.name.includes('[]');\n  }\n  return element.type === 'radio' || Boolean(element.multiple);\n};\n\nexport const maybeDisableSubmit = (selectBox: HTMLSelectElement): void => {\n  const { form } = selectBox;\n  const disallowSubmit = selectBox.getAttribute(\n    DATA_DISALLOW_SUBMIT_WHEN_DISABLED,\n  );\n  if (form && disallowSubmit !== null) {\n    for (const input of form.elements as HTMLCollectionOf<HTMLInputElement>) {\n      if (input !== (selectBox as HTMLElement)) {\n        input.disabled = selectBox.disabled && input.type === 'submit';\n      }\n    }\n  }\n};\n","import { DATA_PARENT_LISTENER, DATA_PARENTS } from './constants';\nimport { FormElement, Parents, ParentsValues, ParentValue } from './types';\nimport {\n  getMultiChoiceValue,\n  isMultiChoice,\n  maybeGetNumberValue,\n} from './utils';\n\nconst getParents = (selectBox: HTMLElement): Parents => {\n  const parentsData = selectBox.getAttribute(DATA_PARENTS);\n  if (parentsData) {\n    return JSON.parse(parentsData);\n  }\n  return [];\n};\n\nconst getParentValue = (element: HTMLInputElement): ParentValue => {\n  if (isMultiChoice(element)) return getMultiChoiceValue(element);\n  if (element.type === 'checkbox') return element.checked;\n  const value = element.value.trim();\n  if (element.type === 'textarea') return value;\n  if (value === '') return null;\n  return maybeGetNumberValue(value);\n};\n\nconst getParentsData = (\n  form: HTMLFormElement,\n  parents: Parents,\n): ParentsValues => {\n  const data: ParentsValues = {};\n  for (const parent of parents) {\n    const element = form.elements.namedItem(parent) as FormElement;\n    if (element) {\n      data[element.name] = getParentValue(element);\n    }\n  }\n  return data;\n};\n\nconst parentHasListener = (parent: HTMLInputElement): boolean =>\n  parent.getAttribute(DATA_PARENT_LISTENER) !== null;\n\nconst setParentHasListener = (parent: HTMLInputElement): void =>\n  parent.setAttribute(DATA_PARENT_LISTENER, 'true');\n\nexport default {\n  getParents,\n  getParentValue,\n  getParentsData,\n  parentHasListener,\n  setParentHasListener,\n};\n","import { Naja } from 'naja';\n\nimport {\n  Request,\n  DependentSelectBoxes,\n  Response,\n  LoadingEvent,\n  LoadedEvent,\n} from './types';\nimport { maybeDisableSubmit } from './utils';\nimport { DATA_LINK, EVENT_LOADED, EVENT_LOADING } from './constants';\n\nclass RequestManager {\n  public constructor(naja: Naja) {\n    this.naja = naja;\n  }\n\n  private naja: Naja;\n\n  public handleResponse = (\n    form: HTMLFormElement,\n    dependentSelectBoxes: DependentSelectBoxes,\n    response: Response,\n  ): void => {\n    for (const id in response) {\n      const element = document.getElementById(id) as HTMLSelectElement;\n      element.disabled = response[id].disabled;\n      element.innerHTML = response[id].options;\n      maybeDisableSubmit(element);\n    }\n    const e: LoadedEvent = new CustomEvent(EVENT_LOADED, {\n      detail: { form, dependentSelectBoxes, response },\n    });\n    this.naja.dispatchEvent(e);\n  };\n\n  public handleRequest = async (\n    form: HTMLFormElement,\n    dependentSelectBoxes: DependentSelectBoxes,\n    request: Request,\n  ): Promise<void> => {\n    const link = form.getAttribute(DATA_LINK);\n    if (!link) {\n      throw new Error(\n        `Form \"${form.id}\" must have \"data-dependent-data-link\" attribute!`,\n      );\n    }\n    const e: LoadingEvent = new CustomEvent(EVENT_LOADING, {\n      detail: { form, dependentSelectBoxes, request },\n    });\n    this.naja.dispatchEvent(e);\n    const response: Response = await this.naja.makeRequest(\n      'POST',\n      link,\n      request,\n      {\n        dataType: 'json',\n        history: false,\n        responseType: 'json',\n      },\n    );\n    this.handleResponse(form, dependentSelectBoxes, response);\n  };\n}\n\nexport default RequestManager;\n","import { DependentSelectBoxes, Parents, Request } from './types';\nimport ParentsManager from './ParentsManager';\n\nconst get = (\n  form: HTMLFormElement,\n  trigger: HTMLInputElement,\n  selectBoxes: DependentSelectBoxes,\n  parents: Parents,\n): Request => {\n  const selectBoxesIds = [];\n  for (const selectBox of selectBoxes) {\n    if (!parents.includes(selectBox.id)) {\n      selectBoxesIds.push(selectBox.id);\n    }\n  }\n  const values = ParentsManager.getParentsData(form, [\n    ...parents,\n    ...selectBoxesIds,\n  ]);\n  return { trigger: trigger.id, values };\n};\n\nexport default { get };\n","import { Naja } from 'naja';\n\nimport ParentsManager from './ParentsManager';\nimport RequestManager from './RequestManager';\nimport { DependentSelectBoxes, FormElement, Parents } from './types';\nimport { SELECT_BOX_SELECTOR } from './constants';\nimport DataManager from './DataManager';\n\nclass DOMManager {\n  public constructor(naja: Naja) {\n    this.requestManager = new RequestManager(naja);\n  }\n\n  private requestManager: RequestManager;\n\n  public addListeners = (\n    parent: HTMLInputElement,\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ): void => {\n    const events = ['change'];\n    if (this.isParentTextBased(parent)) {\n      events.push('keydown');\n    }\n    events.forEach(e =>\n      parent.addEventListener(e, this.handleChange(parents, selectBoxes)),\n    );\n    ParentsManager.setParentHasListener(parent);\n  };\n\n  public findParent = (id: string): FormElement =>\n    document.getElementById(id) as FormElement;\n\n  public findSelectBoxes = (): DependentSelectBoxes =>\n    Array.from(document.querySelectorAll(SELECT_BOX_SELECTOR));\n\n  public handleChange = (\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ) => (event: Event): void => {\n    const trigger = event.target as HTMLInputElement;\n    const form = trigger.form as HTMLFormElement;\n    for (const selectBox of selectBoxes) {\n      const selectBoxParents = ParentsManager.getParents(selectBox);\n      selectBox.disabled = selectBoxParents.includes(trigger.id);\n    }\n    const formSelectBoxes = this.getFormSelectBoxes(form, selectBoxes);\n    this.requestManager.handleRequest(\n      form,\n      formSelectBoxes,\n      DataManager.get(form, trigger, formSelectBoxes, parents),\n    );\n  };\n\n  private getFormSelectBoxes = (\n    form: HTMLFormElement,\n    selectBoxes: DependentSelectBoxes,\n  ): DependentSelectBoxes => selectBoxes.filter(s => s.form === form);\n\n  private isParentTextBased = (parent: HTMLInputElement): boolean =>\n    ['text', 'number', 'textarea'].includes(parent.type);\n}\n\nexport default DOMManager;\n","import { Extension, Naja } from 'naja';\n\nimport DOMManager from './DOMManager';\nimport ParentsManager from './ParentsManager';\nimport { DependentSelectBoxes, Parents } from './types';\nimport { maybeDisableSubmit } from './utils';\n\nclass DependentSelectBox implements Extension {\n  private domManager: DOMManager;\n\n  public readonly initialize = (naja: Naja): void => {\n    this.domManager = new DOMManager(naja);\n    naja.addEventListener('init', this.load);\n    naja.addEventListener('complete', this.load);\n    naja.snippetHandler.addEventListener('afterUpdate', this.load);\n  };\n\n  public readonly load = (): void => {\n    const selectBoxes = this.domManager.findSelectBoxes();\n    for (const selectBox of selectBoxes) {\n      const parents = ParentsManager.getParents(selectBox);\n      parents.forEach(this.initParent(parents, selectBoxes));\n      maybeDisableSubmit(selectBox);\n    }\n  };\n\n  private readonly initParent = (\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ) => (id: string): void => {\n    const parent = this.domManager.findParent(id);\n    if (parent !== null && !ParentsManager.parentHasListener(parent)) {\n      this.domManager.addListeners(parent, parents, selectBoxes);\n    }\n  };\n}\n\nexport default DependentSelectBox;\n","import DependentSelectBox from './DependentSelectBox';\n\nexport * from './DependentSelectBox/constants';\nexport * from './DependentSelectBox/types';\n\nexport default DependentSelectBox;\n"],"sourceRoot":""}