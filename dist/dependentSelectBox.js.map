{"version":3,"sources":["webpack://DependentSelectBox/webpack/universalModuleDefinition","webpack://DependentSelectBox/webpack/bootstrap","webpack://DependentSelectBox/./src/assets/DependentSelectBox/constants.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/RequestManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/DOMManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/ParentsManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/index.ts","webpack://DependentSelectBox/./src/assets/index.ts"],"names":[],"mappings":"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","file":"dependentSelectBox.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"DependentSelectBox\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DependentSelectBox\"] = factory();\n\telse\n\t\troot[\"DependentSelectBox\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export const DATA_LINK = 'data-dependent-data-link';\nexport const DEPENDENT_SELECT_BOX_SELECTOR = '[data-dependent-select-box]';\nexport const EVENT_LOADED: 'dependentSelectBoxLoaded' =\n  'dependentSelectBoxLoaded';\nexport const EVENT_LOADING: 'dependentSelectBoxLoading' =\n  'dependentSelectBoxLoading';\nexport const PARENTS_DATA = 'data-parents';\nexport const PARENT_HAS_EVENT_LISTENER = 'data-has-dependent-listener';\n","import { DependentSelectBoxes, ParentsValues, Response } from './types';\nimport { DATA_LINK, EVENT_LOADED, EVENT_LOADING } from './constants';\n\nclass RequestManager {\n  public constructor(naja: Naja) {\n    this.naja = naja;\n  }\n\n  private naja: Naja;\n\n  public handleResponse = (\n    form: HTMLFormElement,\n    dependentSelectBoxes: DependentSelectBoxes,\n    response: Response,\n  ): void => {\n    for (const id in response) {\n      const element = document.getElementById(id);\n      if (element && element instanceof HTMLSelectElement) {\n        element.disabled = response[id].disabled;\n        element.innerHTML = response[id].options;\n      }\n    }\n    this.naja.fireEvent(EVENT_LOADED, { form, dependentSelectBoxes });\n  };\n\n  public handleRequest = async (\n    form: HTMLFormElement,\n    dependentSelectBoxes: DependentSelectBoxes,\n    data: { data: ParentsValues; trigger: string },\n  ): Promise<void> => {\n    const link = form.getAttribute(DATA_LINK) as string;\n    if (!link) {\n      throw new Error(\n        `Form ${form.id} must have data-dependent-link attribute!`,\n      );\n    }\n    this.naja.fireEvent(EVENT_LOADING, { form, dependentSelectBoxes });\n    const response = await this.naja.makeRequest<Response>('POST', link, data, {\n      dataType: 'json',\n      history: false,\n      responseType: 'json',\n    });\n    this.handleResponse(form, dependentSelectBoxes, response);\n  };\n}\n\nexport default RequestManager;\n","import { DependentSelectBoxes, FormElement, Parents } from './types';\nimport { DEPENDENT_SELECT_BOX_SELECTOR } from './constants';\nimport RequestManager from './RequestManager';\nimport ParentsManager from './ParentsManager';\n\nclass DOMManager {\n  public constructor(naja: Naja, parentsManager: ParentsManager) {\n    this.parentsManager = parentsManager;\n    this.requestManager = new RequestManager(naja);\n  }\n\n  private parentsManager: ParentsManager;\n\n  private requestManager: RequestManager;\n\n  public addListeners = (\n    parent: HTMLInputElement,\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ): void => {\n    const events = ['change'];\n    if (this.isParentTextBased(parent)) {\n      events.push('keydown');\n    }\n    events.forEach(e =>\n      parent.addEventListener(e, this.handleChange(parents, selectBoxes)),\n    );\n    this.parentsManager.setParentHasListener(parent);\n  };\n\n  public findParent = (id: string): FormElement =>\n    document.getElementById(id) as FormElement;\n\n  public findSelectBoxes = (): DependentSelectBoxes =>\n    document.querySelectorAll(\n      DEPENDENT_SELECT_BOX_SELECTOR,\n    ) as DependentSelectBoxes;\n\n  public handleChange = (\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ) => (event: Event): void => {\n    const input = event.target as HTMLInputElement;\n    const form = input.form as HTMLFormElement;\n    for (const selectBox of selectBoxes) {\n      if (selectBox instanceof HTMLSelectElement) {\n        const selectBoxParents = this.parentsManager.getParents(selectBox);\n        selectBox.disabled = selectBoxParents.includes(input.id);\n      }\n    }\n    this.requestManager.handleRequest(form, selectBoxes, {\n      trigger: input.id,\n      data: this.parentsManager.getParentsData(form, parents),\n    });\n  };\n\n  private isParentTextBased = (parent: HTMLInputElement): boolean =>\n    ['text', 'number', 'textarea'].includes(parent.type);\n}\n\nexport default DOMManager;\n","import { FormElement, Parents, ParentsValues, ParentValue } from './types';\nimport { PARENT_HAS_EVENT_LISTENER, PARENTS_DATA } from './constants';\n\nclass ParentsManager {\n  public getParents = (selectBox: HTMLElement): Parents => {\n    const parentsData = selectBox.getAttribute(PARENTS_DATA);\n    if (parentsData) {\n      return JSON.parse(parentsData);\n    }\n    return [];\n  };\n\n  public getParentsData = (\n    form: HTMLFormElement,\n    parents: Parents,\n  ): ParentsValues => {\n    const data: ParentsValues = {};\n    for (const parent of parents) {\n      const element = form.elements.namedItem(parent) as FormElement;\n      if (element) {\n        data[element.name] = this.getParentValue(element);\n      }\n    }\n    return data;\n  };\n\n  private getParentValue = (element: HTMLInputElement): ParentValue => {\n    if (element.type === 'checkbox') return element.checked;\n    const value = element.value.trim();\n    if (value === '') return null;\n    const number = Number(value);\n    if (!Number.isNaN(number)) return number;\n    return value;\n  };\n\n  public parentHasListener = (parent: HTMLInputElement): boolean =>\n    parent.getAttribute(PARENT_HAS_EVENT_LISTENER) !== null;\n\n  public setParentHasListener = (parent: HTMLInputElement): void =>\n    parent.setAttribute(PARENT_HAS_EVENT_LISTENER, 'true');\n}\n\nexport default ParentsManager;\n","import DOMManager from './DOMManager';\nimport ParentsManager from './ParentsManager';\nimport { DependentSelectBoxes, Parents } from './types';\n\nclass DependentSelectBox {\n  public constructor(naja: Naja) {\n    this.naja = naja;\n    this.parentsManager = new ParentsManager();\n    this.domManager = new DOMManager(this.naja, this.parentsManager);\n    this.naja.addEventListener('load', this.init);\n  }\n\n  private readonly domManager: DOMManager;\n\n  private readonly naja: Naja;\n\n  private readonly parentsManager: ParentsManager;\n\n  public init = (): void => {\n    const selectBoxes = this.domManager.findSelectBoxes();\n    for (const selectBox of selectBoxes) {\n      const parents = this.parentsManager.getParents(selectBox);\n      parents.forEach(this.initParent(parents, selectBoxes));\n    }\n  };\n\n  private initParent = (\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ) => (id: string): void => {\n    const parent = this.domManager.findParent(id);\n    if (parent !== null && !this.parentsManager.parentHasListener(parent)) {\n      this.domManager.addListeners(parent, parents, selectBoxes);\n    }\n  };\n}\n\nexport default DependentSelectBox;\n","export { default } from './DependentSelectBox';\n"],"sourceRoot":""}