{"version":3,"sources":["webpack://DependentSelectBox/webpack/universalModuleDefinition","webpack://DependentSelectBox/webpack/bootstrap","webpack://DependentSelectBox/./src/assets/DependentSelectBox/constants.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/utils.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/ParentsManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/RequestManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/DataManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/DOMManager.ts","webpack://DependentSelectBox/./src/assets/DependentSelectBox/index.ts","webpack://DependentSelectBox/./node_modules/naja/dist/Naja.esm.js","webpack://DependentSelectBox/./node_modules/event-target-shim/dist/event-target-shim.js","webpack://DependentSelectBox/./src/assets/all.ts","webpack://DependentSelectBox/(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","DATA_DISALLOW_SUBMIT_WHEN_DISABLED","DATA_LINK","DATA_PARENT_LISTENER","DATA_PARENTS","DATA_SELECT_BOX","EVENT_LOADED","EVENT_LOADING","SELECT_BOX_SELECTOR","maybeGetNumberValue","number","Number","isNaN","maybeDisableSubmit","selectBox","form","disallowSubmit","getAttribute","elements","input","disabled","type","getParentValue","element","includes","Boolean","multiple","isMultiChoice","HTMLSelectElement","selectedOptions","option","push","inputs","document","querySelectorAll","checked","length","getMultiChoiceValue","trim","parentsData","JSON","parse","parents","data","parent","namedItem","setAttribute","naja","handleResponse","dependentSelectBoxes","response","id","getElementById","innerHTML","options","e","CustomEvent","detail","dispatchEvent","handleRequest","request","Promise","link","Error","this","makeRequest","dataType","history","responseType","trigger","selectBoxes","selectBoxesIds","values","ParentsManager","addListeners","events","isParentTextBased","forEach","addEventListener","handleChange","findParent","findSelectBoxes","Array","from","event","target","selectBoxParents","formSelectBoxes","getFormSelectBoxes","requestManager","DataManager","filter","initialize","domManager","load","snippetHandler","initParent","commonjsGlobal","globalThis","global","self","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","constructor","_setPrototypeOf","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","result","Super","NewTarget","arguments","apply","_superPropBase","_get","receiver","base","desc","getOwnPropertyDescriptor","Emitter","callback","listeners","stack","splice","_this","debounce","setTimeout","defaultPrevented","AbortSignal","_Emitter","_super","_this2","aborted","onabort","AbortController","Event","createEvent","initEvent","createEventObject","bubbles","cancelable","signal","polyfillNeeded","__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL","console","log","Request","abortableFetchDecorator","patchTargets","fetch","_patchTargets","_patchTargets$Request","NativeRequest","NativeAbortController","_patchTargets$__FORCE","init","realFetch","isPrototypeOf","undefined","abortError","DOMException","err","reject","cancellation","_","once","race","_abortableFetch","warn","EventTarget","error","_defineProperty","obj","UIHandler","super","location","origin","handleUI","bindUI","body","snippet","selectors","selector","join","bindElement","removeEventListener","handler","item","matches","bindForm","forms","altKey","ctrlKey","shiftKey","metaKey","button","currentTarget","submitForm","clickElement","method","url","originalEvent","tagName","href","hasAttribute","toUpperCase","pathname","search","FormData","append","coords","getBoundingClientRect","Math","max","floor","pageX","left","pageY","top","isUrlAllowed","preventDefault","test","allowedOrigins","some","RegExp","FormsHandler","uiHandler","processForm","initForms","netteForms","Nette","initForm","validateForm","stopImmediatePropagation","RedirectHandler","_element$form","_element$getAttribute","_element$form2","forceRedirect","payload","redirect","makeRedirect","locationAdapter","assign","force","URL","isHardRedirect","SnippetHandler","replace","content","prepend","insertAdjacentHTML","snippets","updateSnippets","fromCache","keys","updateSnippet","operation","op","toLowerCase","title","HistoryHandler","saveUrl","pushNewState","configureMode","popStateHandler","handlePopState","historyAdapter","replaceState","pushState","defaultOptions","uiCache","historyUiCache","buildState","state","ui","handleSnippets","handleTitle","_element$form3","normalizeMode","_element$getAttribute2","_element$form4","postGet","findSnippets","scriptLoader","loadScripts","ScriptLoader","el","createElement","scripts","script","scriptEl","hasAttributes","attrs","attributes","j","head","appendChild","parentNode","removeChild","Naja","redirectHandler","formsHandler","historyHandler","extension","initialized","extensions","urlObject","searchParams","abortController","credentials","headers","Headers","URLSearchParams","set","promise","ok","HttpError","json","message","status","statusText","registerExtension","checkAbortable","onInitialize","saveAbortController","clearAbortController","keyCode","abortable","abort","Map","checkUniqueness","abortPreviousRequest","clearRequest","unique","_this$abortController","abortControllers","delete","privateData","WeakMap","wrappers","pd","retv","assert","setCancelFlag","passiveListener","canceled","eventTarget","eventPhase","stopped","immediateStopped","timeStamp","now","defineRedirectDescriptor","defineCallDescriptor","getWrapper","proto","wrapper","BaseEvent","isFunc","defineWrapper","isStopped","setPassiveListener","stopPropagation","composed","cancelBubble","listenersMap","isObject","x","getListeners","defineEventAttribute","eventTargetPrototype","eventName","node","listenerType","listener","next","prev","newNode","passive","defineEventAttributeDescriptor","defineCustomEventTarget","eventNames","CustomEventTarget","isArray","types","optionsIsObj","capture","wrappedEvent","wrapEvent","handleEvent","setEventPhase","setCurrentTarget","default","g","Function"],"mappings":"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","file":"dependentSelectBox.all.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"DependentSelectBox\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DependentSelectBox\"] = factory();\n\telse\n\t\troot[\"DependentSelectBox\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","export const DATA_DISALLOW_SUBMIT_WHEN_DISABLED =\n  'data-disallow-submit-when-disabled';\nexport const DATA_LINK = 'data-dependent-data-link';\nexport const DATA_PARENT_LISTENER = 'data-has-dependent-listener';\nexport const DATA_PARENTS = 'data-parents';\nexport const DATA_SELECT_BOX = 'data-dependent-select-box';\nexport const EVENT_LOADED = 'dependentSelectBoxLoaded';\nexport const EVENT_LOADING = 'dependentSelectBoxLoading';\nexport const SELECT_BOX_SELECTOR = `[${DATA_SELECT_BOX}]`;\n","import { DATA_DISALLOW_SUBMIT_WHEN_DISABLED } from './constants';\nimport { ParentValue } from './types';\n\nexport const maybeGetNumberValue = (value: string): number | string => {\n  const number = Number(value);\n  if (!Number.isNaN(number)) return number;\n  return value;\n};\n\nexport const getMultiChoiceValue = (element: HTMLInputElement): ParentValue => {\n  const value: ParentValue = [];\n  if (element instanceof HTMLSelectElement) {\n    for (const option of element.selectedOptions) {\n      value.push(maybeGetNumberValue(option.value));\n    }\n  }\n  if (['checkbox', 'radio'].includes(element.type)) {\n    const inputs = document.querySelectorAll(\n      `input[name=\"${element.name}\"]`,\n    ) as NodeListOf<HTMLInputElement>;\n    for (const input of inputs) {\n      if (input.checked) value.push(maybeGetNumberValue(input.value));\n    }\n  }\n  return value.length ? value : null;\n};\n\nexport const isMultiChoice = (element: HTMLInputElement): boolean => {\n  if (element.type === 'checkbox') {\n    return element.name.includes('[]');\n  }\n  return element.type === 'radio' || Boolean(element.multiple);\n};\n\nexport const maybeDisableSubmit = (selectBox: HTMLSelectElement): void => {\n  const { form } = selectBox;\n  const disallowSubmit = selectBox.getAttribute(\n    DATA_DISALLOW_SUBMIT_WHEN_DISABLED,\n  );\n  if (form && disallowSubmit !== null) {\n    for (const input of form.elements as HTMLCollectionOf<HTMLInputElement>) {\n      if (input !== (selectBox as HTMLElement)) {\n        input.disabled = selectBox.disabled && input.type === 'submit';\n      }\n    }\n  }\n};\n","import { DATA_PARENT_LISTENER, DATA_PARENTS } from './constants';\nimport { FormElement, Parents, ParentsValues, ParentValue } from './types';\nimport {\n  getMultiChoiceValue,\n  isMultiChoice,\n  maybeGetNumberValue,\n} from './utils';\n\nconst getParents = (selectBox: HTMLElement): Parents => {\n  const parentsData = selectBox.getAttribute(DATA_PARENTS);\n  if (parentsData) {\n    return JSON.parse(parentsData);\n  }\n  return [];\n};\n\nconst getParentValue = (element: HTMLInputElement): ParentValue => {\n  if (isMultiChoice(element)) return getMultiChoiceValue(element);\n  if (element.type === 'checkbox') return element.checked;\n  const value = element.value.trim();\n  if (element.type === 'textarea') return value;\n  if (value === '') return null;\n  return maybeGetNumberValue(value);\n};\n\nconst getParentsData = (\n  form: HTMLFormElement,\n  parents: Parents,\n): ParentsValues => {\n  const data: ParentsValues = {};\n  for (const parent of parents) {\n    const element = form.elements.namedItem(parent) as FormElement;\n    if (element) {\n      data[element.name] = getParentValue(element);\n    }\n  }\n  return data;\n};\n\nconst parentHasListener = (parent: HTMLInputElement): boolean =>\n  parent.getAttribute(DATA_PARENT_LISTENER) !== null;\n\nconst setParentHasListener = (parent: HTMLInputElement): void =>\n  parent.setAttribute(DATA_PARENT_LISTENER, 'true');\n\nexport default {\n  getParents,\n  getParentValue,\n  getParentsData,\n  parentHasListener,\n  setParentHasListener,\n};\n","import { Naja } from 'naja';\n\nimport {\n  Request,\n  DependentSelectBoxes,\n  Response,\n  LoadingEvent,\n  LoadedEvent,\n} from './types';\nimport { maybeDisableSubmit } from './utils';\nimport { DATA_LINK, EVENT_LOADED, EVENT_LOADING } from './constants';\n\nclass RequestManager {\n  public constructor(naja: Naja) {\n    this.naja = naja;\n  }\n\n  private naja: Naja;\n\n  public handleResponse = (\n    form: HTMLFormElement,\n    dependentSelectBoxes: DependentSelectBoxes,\n    response: Response,\n  ): void => {\n    for (const id in response) {\n      const element = document.getElementById(id) as HTMLSelectElement;\n      element.disabled = response[id].disabled;\n      element.innerHTML = response[id].options;\n      maybeDisableSubmit(element);\n    }\n    const e: LoadedEvent = new CustomEvent(EVENT_LOADED, {\n      detail: { form, dependentSelectBoxes, response },\n    });\n    this.naja.dispatchEvent(e);\n  };\n\n  public handleRequest = async (\n    form: HTMLFormElement,\n    dependentSelectBoxes: DependentSelectBoxes,\n    request: Request,\n  ): Promise<void> => {\n    const link = form.getAttribute(DATA_LINK);\n    if (!link) {\n      throw new Error(\n        `Form \"${form.id}\" must have \"data-dependent-data-link\" attribute!`,\n      );\n    }\n    const e: LoadingEvent = new CustomEvent(EVENT_LOADING, {\n      detail: { form, dependentSelectBoxes, request },\n    });\n    this.naja.dispatchEvent(e);\n    const response: Response = await this.naja.makeRequest(\n      'POST',\n      link,\n      request,\n      {\n        dataType: 'json',\n        history: false,\n        responseType: 'json',\n      },\n    );\n    this.handleResponse(form, dependentSelectBoxes, response);\n  };\n}\n\nexport default RequestManager;\n","import { DependentSelectBoxes, Parents, Request } from './types';\nimport ParentsManager from './ParentsManager';\n\nconst get = (\n  form: HTMLFormElement,\n  trigger: HTMLInputElement,\n  selectBoxes: DependentSelectBoxes,\n  parents: Parents,\n): Request => {\n  const selectBoxesIds = [];\n  for (const selectBox of selectBoxes) {\n    if (!parents.includes(selectBox.id)) {\n      selectBoxesIds.push(selectBox.id);\n    }\n  }\n  const values = ParentsManager.getParentsData(form, [\n    ...parents,\n    ...selectBoxesIds,\n  ]);\n  return { trigger: trigger.id, values };\n};\n\nexport default { get };\n","import { Naja } from 'naja';\n\nimport ParentsManager from './ParentsManager';\nimport RequestManager from './RequestManager';\nimport { DependentSelectBoxes, FormElement, Parents } from './types';\nimport { SELECT_BOX_SELECTOR } from './constants';\nimport DataManager from './DataManager';\n\nclass DOMManager {\n  public constructor(naja: Naja) {\n    this.requestManager = new RequestManager(naja);\n  }\n\n  private requestManager: RequestManager;\n\n  public addListeners = (\n    parent: HTMLInputElement,\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ): void => {\n    const events = ['change'];\n    if (this.isParentTextBased(parent)) {\n      events.push('keydown');\n    }\n    events.forEach(e =>\n      parent.addEventListener(e, this.handleChange(parents, selectBoxes)),\n    );\n    ParentsManager.setParentHasListener(parent);\n  };\n\n  public findParent = (id: string): FormElement =>\n    document.getElementById(id) as FormElement;\n\n  public findSelectBoxes = (): DependentSelectBoxes =>\n    Array.from(document.querySelectorAll(SELECT_BOX_SELECTOR));\n\n  public handleChange = (\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ) => (event: Event): void => {\n    const trigger = event.target as HTMLInputElement;\n    const form = trigger.form as HTMLFormElement;\n    for (const selectBox of selectBoxes) {\n      const selectBoxParents = ParentsManager.getParents(selectBox);\n      selectBox.disabled = selectBoxParents.includes(trigger.id);\n    }\n    const formSelectBoxes = this.getFormSelectBoxes(form, selectBoxes);\n    this.requestManager.handleRequest(\n      form,\n      formSelectBoxes,\n      DataManager.get(form, trigger, formSelectBoxes, parents),\n    );\n  };\n\n  private getFormSelectBoxes = (\n    form: HTMLFormElement,\n    selectBoxes: DependentSelectBoxes,\n  ): DependentSelectBoxes => selectBoxes.filter(s => s.form === form);\n\n  private isParentTextBased = (parent: HTMLInputElement): boolean =>\n    ['text', 'number', 'textarea'].includes(parent.type);\n}\n\nexport default DOMManager;\n","import { Extension, Naja } from 'naja';\n\nimport DOMManager from './DOMManager';\nimport ParentsManager from './ParentsManager';\nimport { DependentSelectBoxes, Parents } from './types';\nimport { maybeDisableSubmit } from './utils';\n\nclass DependentSelectBox implements Extension {\n  private domManager: DOMManager;\n\n  public readonly initialize = (naja: Naja): void => {\n    this.domManager = new DOMManager(naja);\n    naja.addEventListener('load', this.load);\n    naja.snippetHandler.addEventListener('afterUpdate', this.load);\n  };\n\n  public readonly load = (): void => {\n    const selectBoxes = this.domManager.findSelectBoxes();\n    for (const selectBox of selectBoxes) {\n      const parents = ParentsManager.getParents(selectBox);\n      parents.forEach(this.initParent(parents, selectBoxes));\n      maybeDisableSubmit(selectBox);\n    }\n  };\n\n  private readonly initParent = (\n    parents: Parents,\n    selectBoxes: DependentSelectBoxes,\n  ) => (id: string): void => {\n    const parent = this.domManager.findParent(id);\n    if (parent !== null && !ParentsManager.parentHasListener(parent)) {\n      this.domManager.addListeners(parent, parents, selectBoxes);\n    }\n  };\n}\n\nexport default DependentSelectBox;\n","/*\n * Naja.js\n * 2.0.1\n *\n * by Jiří Pudil <https://jiripudil.cz>\n */\nimport { EventTarget as EventTarget$1 } from 'event-target-shim';\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n(function (factory) {\n  \n  factory();\n}((function () {\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n          result;\n\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== \"undefined\" && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  var Emitter = /*#__PURE__*/function () {\n    function Emitter() {\n      _classCallCheck(this, Emitter);\n\n      Object.defineProperty(this, 'listeners', {\n        value: {},\n        writable: true,\n        configurable: true\n      });\n    }\n\n    _createClass(Emitter, [{\n      key: \"addEventListener\",\n      value: function addEventListener(type, callback) {\n        if (!(type in this.listeners)) {\n          this.listeners[type] = [];\n        }\n\n        this.listeners[type].push(callback);\n      }\n    }, {\n      key: \"removeEventListener\",\n      value: function removeEventListener(type, callback) {\n        if (!(type in this.listeners)) {\n          return;\n        }\n\n        var stack = this.listeners[type];\n\n        for (var i = 0, l = stack.length; i < l; i++) {\n          if (stack[i] === callback) {\n            stack.splice(i, 1);\n            return;\n          }\n        }\n      }\n    }, {\n      key: \"dispatchEvent\",\n      value: function dispatchEvent(event) {\n        var _this = this;\n\n        if (!(event.type in this.listeners)) {\n          return;\n        }\n\n        var debounce = function debounce(callback) {\n          setTimeout(function () {\n            return callback.call(_this, event);\n          });\n        };\n\n        var stack = this.listeners[event.type];\n\n        for (var i = 0, l = stack.length; i < l; i++) {\n          debounce(stack[i]);\n        }\n\n        return !event.defaultPrevented;\n      }\n    }]);\n\n    return Emitter;\n  }();\n\n  var AbortSignal = /*#__PURE__*/function (_Emitter) {\n    _inherits(AbortSignal, _Emitter);\n\n    var _super = _createSuper(AbortSignal);\n\n    function AbortSignal() {\n      var _this2;\n\n      _classCallCheck(this, AbortSignal);\n\n      _this2 = _super.call(this); // Some versions of babel does not transpile super() correctly for IE <= 10, if the parent\n      // constructor has failed to run, then \"this.listeners\" will still be undefined and then we call\n      // the parent constructor directly instead as a workaround. For general details, see babel bug:\n      // https://github.com/babel/babel/issues/3041\n      // This hack was added as a fix for the issue described here:\n      // https://github.com/Financial-Times/polyfill-library/pull/59#issuecomment-477558042\n\n      if (!_this2.listeners) {\n        Emitter.call(_assertThisInitialized(_this2));\n      } // Compared to assignment, Object.defineProperty makes properties non-enumerable by default and\n      // we want Object.keys(new AbortController().signal) to be [] for compat with the native impl\n\n\n      Object.defineProperty(_assertThisInitialized(_this2), 'aborted', {\n        value: false,\n        writable: true,\n        configurable: true\n      });\n      Object.defineProperty(_assertThisInitialized(_this2), 'onabort', {\n        value: null,\n        writable: true,\n        configurable: true\n      });\n      return _this2;\n    }\n\n    _createClass(AbortSignal, [{\n      key: \"toString\",\n      value: function toString() {\n        return '[object AbortSignal]';\n      }\n    }, {\n      key: \"dispatchEvent\",\n      value: function dispatchEvent(event) {\n        if (event.type === 'abort') {\n          this.aborted = true;\n\n          if (typeof this.onabort === 'function') {\n            this.onabort.call(this, event);\n          }\n        }\n\n        _get(_getPrototypeOf(AbortSignal.prototype), \"dispatchEvent\", this).call(this, event);\n      }\n    }]);\n\n    return AbortSignal;\n  }(Emitter);\n  var AbortController = /*#__PURE__*/function () {\n    function AbortController() {\n      _classCallCheck(this, AbortController);\n\n      // Compared to assignment, Object.defineProperty makes properties non-enumerable by default and\n      // we want Object.keys(new AbortController()) to be [] for compat with the native impl\n      Object.defineProperty(this, 'signal', {\n        value: new AbortSignal(),\n        writable: true,\n        configurable: true\n      });\n    }\n\n    _createClass(AbortController, [{\n      key: \"abort\",\n      value: function abort() {\n        var event;\n\n        try {\n          event = new Event('abort');\n        } catch (e) {\n          if (typeof document !== 'undefined') {\n            if (!document.createEvent) {\n              // For Internet Explorer 8:\n              event = document.createEventObject();\n              event.type = 'abort';\n            } else {\n              // For Internet Explorer 11:\n              event = document.createEvent('Event');\n              event.initEvent('abort', false, false);\n            }\n          } else {\n            // Fallback where document isn't available:\n            event = {\n              type: 'abort',\n              bubbles: false,\n              cancelable: false\n            };\n          }\n        }\n\n        this.signal.dispatchEvent(event);\n      }\n    }, {\n      key: \"toString\",\n      value: function toString() {\n        return '[object AbortController]';\n      }\n    }]);\n\n    return AbortController;\n  }();\n\n  if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n    // These are necessary to make sure that we get correct output for:\n    // Object.prototype.toString.call(new AbortController())\n    AbortController.prototype[Symbol.toStringTag] = 'AbortController';\n    AbortSignal.prototype[Symbol.toStringTag] = 'AbortSignal';\n  }\n\n  function polyfillNeeded(self) {\n    if (self.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL) {\n      console.log('__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill');\n      return true;\n    } // Note that the \"unfetch\" minimal fetch polyfill defines fetch() without\n    // defining window.Request, and this polyfill need to work on top of unfetch\n    // so the below feature detection needs the !self.AbortController part.\n    // The Request.prototype check is also needed because Safari versions 11.1.2\n    // up to and including 12.1.x has a window.AbortController present but still\n    // does NOT correctly implement abortable fetch:\n    // https://bugs.webkit.org/show_bug.cgi?id=174980#c2\n\n\n    return typeof self.Request === 'function' && !self.Request.prototype.hasOwnProperty('signal') || !self.AbortController;\n  }\n\n  /**\n   * Note: the \"fetch.Request\" default value is available for fetch imported from\n   * the \"node-fetch\" package and not in browsers. This is OK since browsers\n   * will be importing umd-polyfill.js from that path \"self\" is passed the\n   * decorator so the default value will not be used (because browsers that define\n   * fetch also has Request). One quirky setup where self.fetch exists but\n   * self.Request does not is when the \"unfetch\" minimal fetch polyfill is used\n   * on top of IE11; for this case the browser will try to use the fetch.Request\n   * default value which in turn will be undefined but then then \"if (Request)\"\n   * will ensure that you get a patched fetch but still no Request (as expected).\n   * @param {fetch, Request = fetch.Request}\n   * @returns {fetch: abortableFetch, Request: AbortableRequest}\n   */\n\n  function abortableFetchDecorator(patchTargets) {\n    if ('function' === typeof patchTargets) {\n      patchTargets = {\n        fetch: patchTargets\n      };\n    }\n\n    var _patchTargets = patchTargets,\n        fetch = _patchTargets.fetch,\n        _patchTargets$Request = _patchTargets.Request,\n        NativeRequest = _patchTargets$Request === void 0 ? fetch.Request : _patchTargets$Request,\n        NativeAbortController = _patchTargets.AbortController,\n        _patchTargets$__FORCE = _patchTargets.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,\n        __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL = _patchTargets$__FORCE === void 0 ? false : _patchTargets$__FORCE;\n\n    if (!polyfillNeeded({\n      fetch: fetch,\n      Request: NativeRequest,\n      AbortController: NativeAbortController,\n      __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL: __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL\n    })) {\n      return {\n        fetch: fetch,\n        Request: Request\n      };\n    }\n\n    var Request = NativeRequest; // Note that the \"unfetch\" minimal fetch polyfill defines fetch() without\n    // defining window.Request, and this polyfill need to work on top of unfetch\n    // hence we only patch it if it's available. Also we don't patch it if signal\n    // is already available on the Request prototype because in this case support\n    // is present and the patching below can cause a crash since it assigns to\n    // request.signal which is technically a read-only property. This latter error\n    // happens when you run the main5.js node-fetch example in the repo\n    // \"abortcontroller-polyfill-examples\". The exact error is:\n    //   request.signal = init.signal;\n    //   ^\n    // TypeError: Cannot set property signal of #<Request> which has only a getter\n\n    if (Request && !Request.prototype.hasOwnProperty('signal') || __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL) {\n      Request = function Request(input, init) {\n        var signal;\n\n        if (init && init.signal) {\n          signal = init.signal; // Never pass init.signal to the native Request implementation when the polyfill has\n          // been installed because if we're running on top of a browser with a\n          // working native AbortController (i.e. the polyfill was installed due to\n          // __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL being set), then passing our\n          // fake AbortSignal to the native fetch will trigger:\n          // TypeError: Failed to construct 'Request': member signal is not of type AbortSignal.\n\n          delete init.signal;\n        }\n\n        var request = new NativeRequest(input, init);\n\n        if (signal) {\n          Object.defineProperty(request, 'signal', {\n            writable: false,\n            enumerable: false,\n            configurable: true,\n            value: signal\n          });\n        }\n\n        return request;\n      };\n\n      Request.prototype = NativeRequest.prototype;\n    }\n\n    var realFetch = fetch;\n\n    var abortableFetch = function abortableFetch(input, init) {\n      var signal = Request && Request.prototype.isPrototypeOf(input) ? input.signal : init ? init.signal : undefined;\n\n      if (signal) {\n        var abortError;\n\n        try {\n          abortError = new DOMException('Aborted', 'AbortError');\n        } catch (err) {\n          // IE 11 does not support calling the DOMException constructor, use a\n          // regular error object on it instead.\n          abortError = new Error('Aborted');\n          abortError.name = 'AbortError';\n        } // Return early if already aborted, thus avoiding making an HTTP request\n\n\n        if (signal.aborted) {\n          return Promise.reject(abortError);\n        } // Turn an event into a promise, reject it once `abort` is dispatched\n\n\n        var cancellation = new Promise(function (_, reject) {\n          signal.addEventListener('abort', function () {\n            return reject(abortError);\n          }, {\n            once: true\n          });\n        });\n\n        if (init && init.signal) {\n          // Never pass .signal to the native implementation when the polyfill has\n          // been installed because if we're running on top of a browser with a\n          // working native AbortController (i.e. the polyfill was installed due to\n          // __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL being set), then passing our\n          // fake AbortSignal to the native fetch will trigger:\n          // TypeError: Failed to execute 'fetch' on 'Window': member signal is not of type AbortSignal.\n          delete init.signal;\n        } // Return the fastest promise (don't need to wait for request to finish)\n\n\n        return Promise.race([cancellation, realFetch(input, init)]);\n      }\n\n      return realFetch(input, init);\n    };\n\n    return {\n      fetch: abortableFetch,\n      Request: Request\n    };\n  }\n\n  (function (self) {\n\n    if (!polyfillNeeded(self)) {\n      return;\n    }\n\n    if (!self.fetch) {\n      console.warn('fetch() is not available, cannot install abortcontroller-polyfill');\n      return;\n    }\n\n    var _abortableFetch = abortableFetchDecorator(self),\n        fetch = _abortableFetch.fetch,\n        Request = _abortableFetch.Request;\n\n    self.fetch = fetch;\n    self.Request = Request;\n    Object.defineProperty(self, 'AbortController', {\n      writable: true,\n      enumerable: false,\n      configurable: true,\n      value: AbortController\n    });\n    Object.defineProperty(self, 'AbortSignal', {\n      writable: true,\n      enumerable: false,\n      configurable: true,\n      value: AbortSignal\n    });\n  })(typeof self !== 'undefined' ? self : commonjsGlobal);\n\n})));\n\n// https://bugs.webkit.org/show_bug.cgi?id=174980\n\ntry {\n  new window.EventTarget();\n} catch (error) {\n  window.EventTarget = EventTarget$1;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nclass UIHandler extends EventTarget {\n  constructor(naja) {\n    super();\n\n    _defineProperty(this, \"selector\", '.ajax');\n\n    _defineProperty(this, \"allowedOrigins\", [window.location.origin]);\n\n    _defineProperty(this, \"handler\", this.handleUI.bind(this));\n\n    this.naja = naja;\n    naja.addEventListener('init', this.initialize.bind(this));\n  }\n\n  initialize() {\n    this.bindUI(window.document.body);\n    this.naja.snippetHandler.addEventListener('afterUpdate', event => {\n      const {\n        snippet\n      } = event.detail;\n      this.bindUI(snippet);\n    });\n  }\n\n  bindUI(element) {\n    const selectors = [`a${this.selector}`, `input[type=\"submit\"]${this.selector}`, `input[type=\"image\"]${this.selector}`, `button[type=\"submit\"]${this.selector}`, `form${this.selector} input[type=\"submit\"]`, `form${this.selector} input[type=\"image\"]`, `form${this.selector} button[type=\"submit\"]`].join(', ');\n\n    const bindElement = element => {\n      element.removeEventListener('click', this.handler);\n      element.addEventListener('click', this.handler);\n    };\n\n    const elements = element.querySelectorAll(selectors);\n\n    for (let i = 0; i < elements.length; i++) {\n      bindElement(elements.item(i));\n    }\n\n    if (element.matches(selectors)) {\n      bindElement(element);\n    }\n\n    const bindForm = form => {\n      form.removeEventListener('submit', this.handler);\n      form.addEventListener('submit', this.handler);\n    };\n\n    if (element.matches(`form${this.selector}`)) {\n      bindForm(element);\n    }\n\n    const forms = element.querySelectorAll(`form${this.selector}`);\n\n    for (let i = 0; i < forms.length; i++) {\n      bindForm(forms.item(i));\n    }\n  }\n\n  handleUI(event) {\n    if (event.altKey || event.ctrlKey || event.shiftKey || event.metaKey || event.button) {\n      return;\n    }\n\n    const element = event.currentTarget;\n    const options = {};\n\n    if (event.type === 'submit') {\n      this.submitForm(element, options, event);\n    } else if (event.type === 'click') {\n      this.clickElement(element, options, event);\n    }\n  }\n\n  clickElement(element, options = {}, event) {\n    let method, url, data;\n\n    if (!this.dispatchEvent(new CustomEvent('interaction', {\n      cancelable: true,\n      detail: {\n        element,\n        originalEvent: event,\n        options\n      }\n    }))) {\n      if (event) {\n        event.preventDefault();\n      }\n\n      return;\n    }\n\n    if (element.tagName === 'A') {\n      method = 'GET';\n      url = element.href;\n      data = null;\n    } else if (element.tagName === 'INPUT' || element.tagName === 'BUTTON') {\n      const {\n        form\n      } = element; // eslint-disable-next-line no-nested-ternary,no-extra-parens\n\n      method = element.hasAttribute('formmethod') ? element.getAttribute('formmethod').toUpperCase() : form.hasAttribute('method') ? form.getAttribute('method').toUpperCase() : 'GET';\n      url = element.getAttribute('formaction') || form.getAttribute('action') || window.location.pathname + window.location.search;\n      data = new FormData(form);\n\n      if (element.type === 'submit' || element.tagName === 'BUTTON') {\n        data.append(element.name, element.value || '');\n      } else if (element.type === 'image') {\n        const coords = element.getBoundingClientRect();\n        data.append(`${element.name}.x`, Math.max(0, Math.floor(event.pageX - coords.left)));\n        data.append(`${element.name}.y`, Math.max(0, Math.floor(event.pageY - coords.top)));\n      }\n    }\n\n    if (this.isUrlAllowed(url)) {\n      if (event) {\n        event.preventDefault();\n      }\n\n      this.naja.makeRequest(method, url, data, options);\n    }\n  }\n\n  submitForm(form, options = {}, event) {\n    if (!this.dispatchEvent(new CustomEvent('interaction', {\n      cancelable: true,\n      detail: {\n        element: form,\n        originalEvent: event,\n        options\n      }\n    }))) {\n      if (event) {\n        event.preventDefault();\n      }\n\n      return;\n    }\n\n    const method = form.hasAttribute('method') ? form.getAttribute('method').toUpperCase() : 'GET';\n    const url = form.getAttribute('action') || window.location.pathname + window.location.search;\n    const data = new FormData(form);\n\n    if (this.isUrlAllowed(url)) {\n      if (event) {\n        event.preventDefault();\n      }\n\n      this.naja.makeRequest(method, url, data, options);\n    }\n  }\n\n  isUrlAllowed(url) {\n    // ignore non-URL URIs (javascript:, data:, ...)\n    if (/^(?!https?)[^:/?#]+:/i.test(url)) {\n      return false;\n    }\n\n    return !/^https?/i.test(url) || this.allowedOrigins.some(origin => new RegExp(`^${origin}`, 'i').test(url));\n  }\n\n}\n\nclass FormsHandler {\n  constructor(naja) {\n    _defineProperty(this, \"netteForms\", void 0);\n\n    this.naja = naja;\n    naja.addEventListener('init', this.initialize.bind(this));\n    naja.uiHandler.addEventListener('interaction', this.processForm.bind(this));\n  }\n\n  initialize() {\n    this.initForms(window.document.body);\n    this.naja.snippetHandler.addEventListener('afterUpdate', event => {\n      const {\n        snippet\n      } = event.detail;\n      this.initForms(snippet);\n    });\n  }\n\n  initForms(element) {\n    const netteForms = this.netteForms || window.Nette;\n\n    if (netteForms) {\n      if (element.tagName === 'form') {\n        netteForms.initForm(element);\n      }\n\n      const forms = element.querySelectorAll('form');\n\n      for (let i = 0; i < forms.length; i++) {\n        netteForms.initForm(forms.item(i));\n      }\n    }\n  }\n\n  processForm(event) {\n    const {\n      element,\n      originalEvent\n    } = event.detail;\n\n    if (element.form) {\n      element.form['nette-submittedBy'] = element;\n    }\n\n    const netteForms = this.netteForms || window.Nette;\n\n    if ((element.tagName === 'FORM' || element.form) && netteForms && !netteForms.validateForm(element)) {\n      if (originalEvent) {\n        originalEvent.stopImmediatePropagation();\n        originalEvent.preventDefault();\n      }\n\n      event.preventDefault();\n    }\n  }\n\n}\n\nclass RedirectHandler extends EventTarget {\n  constructor(naja) {\n    super();\n    this.naja = naja;\n    naja.uiHandler.addEventListener('interaction', event => {\n      var _element$form;\n\n      const {\n        element,\n        options\n      } = event.detail;\n\n      if (!element) {\n        return;\n      }\n\n      if (element.hasAttribute('data-naja-force-redirect') || ((_element$form = element.form) === null || _element$form === void 0 ? void 0 : _element$form.hasAttribute('data-naja-force-redirect'))) {\n        var _element$getAttribute, _element$form2;\n\n        const value = (_element$getAttribute = element.getAttribute('data-naja-force-redirect')) !== null && _element$getAttribute !== void 0 ? _element$getAttribute : (_element$form2 = element.form) === null || _element$form2 === void 0 ? void 0 : _element$form2.getAttribute('data-naja-force-redirect');\n        options.forceRedirect = value !== 'off';\n      }\n    });\n    naja.addEventListener('success', event => {\n      const {\n        payload,\n        options\n      } = event.detail;\n\n      if (payload.redirect) {\n        this.makeRedirect(payload.redirect, options.forceRedirect, options);\n        event.stopImmediatePropagation();\n      }\n    });\n    this.locationAdapter = {\n      assign: url => window.location.assign(url)\n    };\n  }\n\n  makeRedirect(url, force, options = {}) {\n    if (url instanceof URL) {\n      url = url.href;\n    }\n\n    let isHardRedirect = force || !this.naja.uiHandler.isUrlAllowed(url);\n    const canRedirect = this.dispatchEvent(new CustomEvent('redirect', {\n      cancelable: true,\n      detail: {\n        url,\n        isHardRedirect,\n\n        setHardRedirect(value) {\n          isHardRedirect = !!value;\n        },\n\n        options\n      }\n    }));\n\n    if (!canRedirect) {\n      return;\n    }\n\n    if (isHardRedirect) {\n      this.locationAdapter.assign(url);\n    } else {\n      this.naja.makeRequest('GET', url, null, options);\n    }\n  }\n\n}\n\nclass SnippetHandler extends EventTarget {\n  constructor(naja) {\n    super();\n\n    _defineProperty(this, \"op\", {\n      replace: (snippet, content) => {\n        snippet.innerHTML = content;\n      },\n      prepend: (snippet, content) => snippet.insertAdjacentHTML('afterbegin', content),\n      append: (snippet, content) => snippet.insertAdjacentHTML('beforeend', content)\n    });\n\n    naja.addEventListener('success', event => {\n      const {\n        options,\n        payload\n      } = event.detail;\n\n      if (payload.snippets) {\n        this.updateSnippets(payload.snippets, false, options);\n      }\n    });\n  }\n\n  updateSnippets(snippets, fromCache = false, options = {}) {\n    Object.keys(snippets).forEach(id => {\n      const snippet = document.getElementById(id);\n\n      if (snippet) {\n        this.updateSnippet(snippet, snippets[id], fromCache, options);\n      }\n    });\n  }\n\n  updateSnippet(snippet, content, fromCache, options) {\n    let operation = this.op.replace;\n\n    if ((snippet.hasAttribute('data-naja-snippet-prepend') || snippet.hasAttribute('data-ajax-prepend')) && !fromCache) {\n      operation = this.op.prepend;\n    } else if ((snippet.hasAttribute('data-naja-snippet-append') || snippet.hasAttribute('data-ajax-append')) && !fromCache) {\n      operation = this.op.append;\n    }\n\n    const canUpdate = this.dispatchEvent(new CustomEvent('beforeUpdate', {\n      cancelable: true,\n      detail: {\n        snippet,\n        content,\n        fromCache,\n        operation,\n\n        changeOperation(value) {\n          operation = value;\n        },\n\n        options\n      }\n    }));\n\n    if (!canUpdate) {\n      return;\n    }\n\n    if (snippet.tagName.toLowerCase() === 'title') {\n      document.title = content;\n    } else {\n      operation(snippet, content);\n    }\n\n    this.dispatchEvent(new CustomEvent('afterUpdate', {\n      cancelable: true,\n      detail: {\n        snippet,\n        content,\n        fromCache,\n        operation,\n        options\n      }\n    }));\n  }\n\n}\n\nclass HistoryHandler {\n  constructor(naja) {\n    _defineProperty(this, \"href\", null);\n\n    _defineProperty(this, \"uiCache\", true);\n\n    this.naja = naja;\n    naja.addEventListener('init', this.initialize.bind(this));\n    naja.addEventListener('before', this.saveUrl.bind(this));\n    naja.addEventListener('success', this.pushNewState.bind(this));\n    naja.uiHandler.addEventListener('interaction', this.configureMode.bind(this));\n    this.popStateHandler = this.handlePopState.bind(this);\n    this.historyAdapter = {\n      replaceState: (data, title, url) => window.history.replaceState(data, title, url),\n      pushState: (data, title, url) => window.history.pushState(data, title, url)\n    };\n  }\n\n  initialize(event) {\n    const {\n      defaultOptions\n    } = event.detail;\n\n    if ('historyUiCache' in defaultOptions) {\n      this.uiCache = defaultOptions.historyUiCache;\n    }\n\n    window.addEventListener('popstate', this.popStateHandler);\n    this.historyAdapter.replaceState(this.buildState(window.location.href, this.uiCache), window.document.title, window.location.href);\n  }\n\n  handlePopState(e) {\n    if (!e.state) {\n      return;\n    }\n\n    if (e.state.ui) {\n      this.handleSnippets(e.state.ui);\n      this.handleTitle(e.state.title);\n    } else if (e.state.ui === false) {\n      this.naja.makeRequest('GET', e.state.href, null, {\n        history: false,\n        historyUiCache: false\n      });\n    }\n  }\n\n  saveUrl(event) {\n    const {\n      url\n    } = event.detail;\n    this.href = url;\n  }\n\n  configureMode(event) {\n    var _element$form, _element$form3;\n\n    const {\n      element,\n      options\n    } = event.detail; // propagate mode to options\n\n    if (!element) {\n      return;\n    }\n\n    if (element.hasAttribute('data-naja-history') || ((_element$form = element.form) === null || _element$form === void 0 ? void 0 : _element$form.hasAttribute('data-naja-history'))) {\n      var _element$getAttribute, _element$form2;\n\n      const value = (_element$getAttribute = element.getAttribute('data-naja-history')) !== null && _element$getAttribute !== void 0 ? _element$getAttribute : (_element$form2 = element.form) === null || _element$form2 === void 0 ? void 0 : _element$form2.getAttribute('data-naja-history');\n      options.history = this.constructor.normalizeMode(value);\n    }\n\n    if (element.hasAttribute('data-naja-history-cache') || ((_element$form3 = element.form) === null || _element$form3 === void 0 ? void 0 : _element$form3.hasAttribute('data-naja-history-nocache'))) {\n      var _element$getAttribute2, _element$form4;\n\n      const value = (_element$getAttribute2 = element.getAttribute('data-naja-history-cache')) !== null && _element$getAttribute2 !== void 0 ? _element$getAttribute2 : (_element$form4 = element.form) === null || _element$form4 === void 0 ? void 0 : _element$form4.getAttribute('data-naja-history-cache');\n      options.historyUiCache = value !== 'off';\n    }\n  }\n\n  static normalizeMode(mode) {\n    if (mode === 'off' || mode === false) {\n      return false;\n    } else if (mode === 'replace') {\n      return 'replace';\n    }\n\n    return true;\n  }\n\n  pushNewState(event) {\n    const {\n      payload,\n      options\n    } = event.detail;\n    const mode = this.constructor.normalizeMode(options.history);\n\n    if (mode === false) {\n      return;\n    }\n\n    if (payload.postGet && payload.url) {\n      this.href = payload.url;\n    }\n\n    const method = mode === 'replace' ? 'replaceState' : 'pushState';\n    const uiCache = options.historyUiCache === true || options.historyUiCache !== false && this.uiCache; // eslint-disable-line no-extra-parens\n\n    this.historyAdapter[method](this.buildState(this.href, uiCache), window.document.title, this.href);\n    this.href = null;\n  }\n\n  buildState(href, uiCache) {\n    const state = {\n      href\n    };\n\n    if (uiCache) {\n      state.title = window.document.title;\n      state.ui = this.findSnippets();\n    } else {\n      state.ui = false;\n    }\n\n    return state;\n  }\n\n  findSnippets() {\n    const result = {};\n    const snippets = window.document.querySelectorAll('[id^=\"snippet-\"]');\n\n    for (let i = 0; i < snippets.length; i++) {\n      const snippet = snippets.item(i);\n\n      if (!snippet.hasAttribute('data-naja-history-nocache') && !snippet.hasAttribute('data-history-nocache')) {\n        result[snippet.id] = snippet.innerHTML;\n      }\n    }\n\n    return result;\n  }\n\n  handleSnippets(snippets) {\n    this.naja.snippetHandler.updateSnippets(snippets, true);\n    this.naja.scriptLoader.loadScripts(snippets);\n  }\n\n  handleTitle(title) {\n    window.document.title = title;\n  }\n\n}\n\nclass ScriptLoader {\n  constructor(naja) {\n    naja.addEventListener('success', event => {\n      const {\n        payload\n      } = event.detail;\n\n      if (payload.snippets) {\n        this.loadScripts(payload.snippets);\n      }\n    });\n  }\n\n  loadScripts(snippets) {\n    Object.keys(snippets).forEach(id => {\n      const content = snippets[id];\n\n      if (!/<script/i.test(content)) {\n        return;\n      }\n\n      const el = window.document.createElement('div');\n      el.innerHTML = content;\n      const scripts = el.querySelectorAll('script');\n\n      for (let i = 0; i < scripts.length; i++) {\n        const script = scripts.item(i);\n        const scriptEl = window.document.createElement('script');\n        scriptEl.innerHTML = script.innerHTML;\n\n        if (script.hasAttributes()) {\n          const attrs = script.attributes;\n\n          for (let j = 0; j < attrs.length; j++) {\n            const attrName = attrs[j].name;\n            scriptEl[attrName] = attrs[j].value;\n          }\n        }\n\n        window.document.head.appendChild(scriptEl).parentNode.removeChild(scriptEl);\n      }\n    });\n  }\n\n}\n\nclass Naja extends EventTarget {\n  constructor(uiHandler, redirectHandler, snippetHandler, formsHandler, historyHandler, scriptLoader) {\n    super();\n\n    _defineProperty(this, \"VERSION\", 2);\n\n    _defineProperty(this, \"initialized\", false);\n\n    _defineProperty(this, \"uiHandler\", null);\n\n    _defineProperty(this, \"redirectHandler\", null);\n\n    _defineProperty(this, \"snippetHandler\", null);\n\n    _defineProperty(this, \"formsHandler\", null);\n\n    _defineProperty(this, \"historyHandler\", null);\n\n    _defineProperty(this, \"scriptLoader\", null);\n\n    _defineProperty(this, \"extensions\", []);\n\n    _defineProperty(this, \"defaultOptions\", {});\n\n    this.uiHandler = uiHandler ? new uiHandler(this) : new UIHandler(this);\n    this.redirectHandler = redirectHandler ? new redirectHandler(this) : new RedirectHandler(this);\n    this.snippetHandler = snippetHandler ? new snippetHandler(this) : new SnippetHandler(this);\n    this.formsHandler = formsHandler ? new formsHandler(this) : new FormsHandler(this);\n    this.historyHandler = historyHandler ? new historyHandler(this) : new HistoryHandler(this);\n    this.scriptLoader = scriptLoader ? new scriptLoader(this) : new ScriptLoader(this);\n  }\n\n  registerExtension(extension) {\n    if (this.initialized) {\n      extension.initialize(this);\n    }\n\n    this.extensions.push(extension);\n  }\n\n  initialize(defaultOptions = {}) {\n    if (this.initialized) {\n      throw new Error('Cannot initialize Naja, it is already initialized.');\n    }\n\n    this.defaultOptions = defaultOptions;\n    this.extensions.forEach(extension => extension.initialize(this));\n    this.dispatchEvent(new CustomEvent('init', {\n      detail: {\n        defaultOptions\n      }\n    }));\n    this.initialized = true;\n  }\n\n  async makeRequest(method, url, data = null, options = {}) {\n    if (url instanceof URL) {\n      url = url.href;\n    }\n\n    options = { ...this.defaultOptions,\n      ...options,\n      fetch: { ...(this.defaultOptions.fetch || {}),\n        ...(options.fetch || {})\n      }\n    };\n\n    if (method.toUpperCase() === 'GET' && data instanceof FormData) {\n      const urlObject = new URL(url, location.href);\n\n      for (const [key, value] of data) {\n        urlObject.searchParams.append(key, value);\n      }\n\n      url = urlObject.toString();\n      data = null;\n    }\n\n    const abortController = new AbortController();\n    const request = new Request(url, {\n      credentials: 'same-origin',\n      ...options.fetch,\n      method,\n      headers: new Headers(options.fetch.headers || {}),\n      body: data !== null && Object.getPrototypeOf(data) === Object.prototype ? new URLSearchParams(data) : data,\n      signal: abortController.signal\n    }); // impersonate XHR so that Nette can detect isAjax()\n\n    request.headers.set('X-Requested-With', 'XMLHttpRequest');\n\n    if (!this.dispatchEvent(new CustomEvent('before', {\n      cancelable: true,\n      detail: {\n        request,\n        method,\n        url,\n        data,\n        options\n      }\n    }))) {\n      return {};\n    }\n\n    const promise = window.fetch(request);\n    this.dispatchEvent(new CustomEvent('start', {\n      detail: {\n        request,\n        promise,\n        abortController,\n        options\n      }\n    }));\n    let response, payload;\n\n    try {\n      response = await promise;\n\n      if (!response.ok) {\n        throw new HttpError(response);\n      }\n\n      payload = await response.json();\n    } catch (error) {\n      if (error.name === 'AbortError') {\n        this.dispatchEvent(new CustomEvent('abort', {\n          detail: {\n            request,\n            error,\n            options\n          }\n        }));\n        this.dispatchEvent(new CustomEvent('complete', {\n          detail: {\n            request,\n            response,\n            payload: undefined,\n            error,\n            options\n          }\n        }));\n        return {};\n      }\n\n      this.dispatchEvent(new CustomEvent('error', {\n        detail: {\n          request,\n          response,\n          error,\n          options\n        }\n      }));\n      this.dispatchEvent(new CustomEvent('complete', {\n        detail: {\n          request,\n          response,\n          payload: undefined,\n          error,\n          options\n        }\n      }));\n      throw error;\n    }\n\n    this.dispatchEvent(new CustomEvent('success', {\n      detail: {\n        request,\n        response,\n        payload,\n        options\n      }\n    }));\n    this.dispatchEvent(new CustomEvent('complete', {\n      detail: {\n        request,\n        response,\n        payload,\n        error: undefined,\n        options\n      }\n    }));\n    return payload;\n  }\n\n}\nclass HttpError extends Error {\n  constructor(response) {\n    const message = `HTTP ${response.status}: ${response.statusText}`;\n    super(message);\n    this.name = this.constructor.name;\n    this.stack = new Error(message).stack;\n    this.response = response;\n  }\n\n}\n\nclass AbortExtension {\n  constructor() {\n    _defineProperty(this, \"abortable\", true);\n\n    _defineProperty(this, \"abortController\", null);\n  }\n\n  initialize(naja) {\n    naja.uiHandler.addEventListener('interaction', this.checkAbortable.bind(this));\n    naja.addEventListener('init', this.onInitialize.bind(this));\n    naja.addEventListener('before', this.checkAbortable.bind(this));\n    naja.addEventListener('start', this.saveAbortController.bind(this));\n    naja.addEventListener('complete', this.clearAbortController.bind(this));\n  }\n\n  onInitialize() {\n    document.addEventListener('keydown', event => {\n      if (this.abortController !== null && ('key' in event ? event.key === 'Escape' : event.keyCode === 27) && !(event.ctrlKey || event.shiftKey || event.altKey || event.metaKey) && this.abortable) {\n        this.abortController.abort();\n        this.abortController = null;\n      }\n    });\n  }\n\n  checkAbortable(event) {\n    var _element$getAttribute, _element$form;\n\n    const {\n      element,\n      options\n    } = event.detail;\n    this.abortable = element ? ((_element$getAttribute = element.getAttribute('data-naja-abort')) !== null && _element$getAttribute !== void 0 ? _element$getAttribute : (_element$form = element.form) === null || _element$form === void 0 ? void 0 : _element$form.getAttribute('data-naja-abort')) !== 'off' // eslint-disable-line no-extra-parens\n    : options.abort !== false; // propagate to options if called in interaction event\n\n    options.abort = this.abortable;\n  }\n\n  saveAbortController(event) {\n    const {\n      abortController\n    } = event.detail;\n    this.abortController = abortController;\n  }\n\n  clearAbortController() {\n    this.abortController = null;\n    this.abortable = true;\n  }\n\n}\n\nclass UniqueExtension {\n  constructor() {\n    _defineProperty(this, \"abortControllers\", new Map());\n  }\n\n  initialize(naja) {\n    naja.uiHandler.addEventListener('interaction', this.checkUniqueness.bind(this));\n    naja.addEventListener('start', this.abortPreviousRequest.bind(this));\n    naja.addEventListener('complete', this.clearRequest.bind(this));\n  }\n\n  checkUniqueness(event) {\n    var _element$getAttribute, _element$form;\n\n    const {\n      element,\n      options\n    } = event.detail;\n    const unique = (_element$getAttribute = element.getAttribute('data-naja-unique')) !== null && _element$getAttribute !== void 0 ? _element$getAttribute : (_element$form = element.form) === null || _element$form === void 0 ? void 0 : _element$form.getAttribute('data-naja-unique');\n    options.unique = unique === 'off' ? false : unique !== null && unique !== void 0 ? unique : 'default';\n  }\n\n  abortPreviousRequest(event) {\n    const {\n      abortController,\n      options\n    } = event.detail;\n\n    if (options.unique !== false) {\n      var _this$abortController;\n\n      (_this$abortController = this.abortControllers.get(options.unique)) === null || _this$abortController === void 0 ? void 0 : _this$abortController.abort();\n      this.abortControllers.set(options.unique, abortController);\n    }\n  }\n\n  clearRequest(event) {\n    const {\n      request,\n      options\n    } = event.detail;\n\n    if (!request.signal.aborted) {\n      this.abortControllers.delete(options.unique);\n    }\n  }\n\n}\n\nconst naja = new Naja();\nnaja.registerExtension(new AbortExtension());\nnaja.registerExtension(new UniqueExtension());\n\nexport default naja;\nexport { HttpError, Naja };\n//# sourceMappingURL=Naja.esm.js.map\n","/**\n * @author Toru Nagashima <https://github.com/mysticatea>\n * @copyright 2015 Toru Nagashima. All rights reserved.\n * See LICENSE file in root directory for full license.\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n/**\n * @typedef {object} PrivateData\n * @property {EventTarget} eventTarget The event target.\n * @property {{type:string}} event The original event object.\n * @property {number} eventPhase The current event phase.\n * @property {EventTarget|null} currentTarget The current event target.\n * @property {boolean} canceled The flag to prevent default.\n * @property {boolean} stopped The flag to stop propagation.\n * @property {boolean} immediateStopped The flag to stop propagation immediately.\n * @property {Function|null} passiveListener The listener if the current listener is passive. Otherwise this is null.\n * @property {number} timeStamp The unix time.\n * @private\n */\n\n/**\n * Private data for event wrappers.\n * @type {WeakMap<Event, PrivateData>}\n * @private\n */\nconst privateData = new WeakMap();\n\n/**\n * Cache for wrapper classes.\n * @type {WeakMap<Object, Function>}\n * @private\n */\nconst wrappers = new WeakMap();\n\n/**\n * Get private data.\n * @param {Event} event The event object to get private data.\n * @returns {PrivateData} The private data of the event.\n * @private\n */\nfunction pd(event) {\n    const retv = privateData.get(event);\n    console.assert(\n        retv != null,\n        \"'this' is expected an Event object, but got\",\n        event\n    );\n    return retv\n}\n\n/**\n * https://dom.spec.whatwg.org/#set-the-canceled-flag\n * @param data {PrivateData} private data.\n */\nfunction setCancelFlag(data) {\n    if (data.passiveListener != null) {\n        if (\n            typeof console !== \"undefined\" &&\n            typeof console.error === \"function\"\n        ) {\n            console.error(\n                \"Unable to preventDefault inside passive event listener invocation.\",\n                data.passiveListener\n            );\n        }\n        return\n    }\n    if (!data.event.cancelable) {\n        return\n    }\n\n    data.canceled = true;\n    if (typeof data.event.preventDefault === \"function\") {\n        data.event.preventDefault();\n    }\n}\n\n/**\n * @see https://dom.spec.whatwg.org/#interface-event\n * @private\n */\n/**\n * The event wrapper.\n * @constructor\n * @param {EventTarget} eventTarget The event target of this dispatching.\n * @param {Event|{type:string}} event The original event to wrap.\n */\nfunction Event(eventTarget, event) {\n    privateData.set(this, {\n        eventTarget,\n        event,\n        eventPhase: 2,\n        currentTarget: eventTarget,\n        canceled: false,\n        stopped: false,\n        immediateStopped: false,\n        passiveListener: null,\n        timeStamp: event.timeStamp || Date.now(),\n    });\n\n    // https://heycam.github.io/webidl/#Unforgeable\n    Object.defineProperty(this, \"isTrusted\", { value: false, enumerable: true });\n\n    // Define accessors\n    const keys = Object.keys(event);\n    for (let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        if (!(key in this)) {\n            Object.defineProperty(this, key, defineRedirectDescriptor(key));\n        }\n    }\n}\n\n// Should be enumerable, but class methods are not enumerable.\nEvent.prototype = {\n    /**\n     * The type of this event.\n     * @type {string}\n     */\n    get type() {\n        return pd(this).event.type\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     */\n    get target() {\n        return pd(this).eventTarget\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     */\n    get currentTarget() {\n        return pd(this).currentTarget\n    },\n\n    /**\n     * @returns {EventTarget[]} The composed path of this event.\n     */\n    composedPath() {\n        const currentTarget = pd(this).currentTarget;\n        if (currentTarget == null) {\n            return []\n        }\n        return [currentTarget]\n    },\n\n    /**\n     * Constant of NONE.\n     * @type {number}\n     */\n    get NONE() {\n        return 0\n    },\n\n    /**\n     * Constant of CAPTURING_PHASE.\n     * @type {number}\n     */\n    get CAPTURING_PHASE() {\n        return 1\n    },\n\n    /**\n     * Constant of AT_TARGET.\n     * @type {number}\n     */\n    get AT_TARGET() {\n        return 2\n    },\n\n    /**\n     * Constant of BUBBLING_PHASE.\n     * @type {number}\n     */\n    get BUBBLING_PHASE() {\n        return 3\n    },\n\n    /**\n     * The target of this event.\n     * @type {number}\n     */\n    get eventPhase() {\n        return pd(this).eventPhase\n    },\n\n    /**\n     * Stop event bubbling.\n     * @returns {void}\n     */\n    stopPropagation() {\n        const data = pd(this);\n\n        data.stopped = true;\n        if (typeof data.event.stopPropagation === \"function\") {\n            data.event.stopPropagation();\n        }\n    },\n\n    /**\n     * Stop event bubbling.\n     * @returns {void}\n     */\n    stopImmediatePropagation() {\n        const data = pd(this);\n\n        data.stopped = true;\n        data.immediateStopped = true;\n        if (typeof data.event.stopImmediatePropagation === \"function\") {\n            data.event.stopImmediatePropagation();\n        }\n    },\n\n    /**\n     * The flag to be bubbling.\n     * @type {boolean}\n     */\n    get bubbles() {\n        return Boolean(pd(this).event.bubbles)\n    },\n\n    /**\n     * The flag to be cancelable.\n     * @type {boolean}\n     */\n    get cancelable() {\n        return Boolean(pd(this).event.cancelable)\n    },\n\n    /**\n     * Cancel this event.\n     * @returns {void}\n     */\n    preventDefault() {\n        setCancelFlag(pd(this));\n    },\n\n    /**\n     * The flag to indicate cancellation state.\n     * @type {boolean}\n     */\n    get defaultPrevented() {\n        return pd(this).canceled\n    },\n\n    /**\n     * The flag to be composed.\n     * @type {boolean}\n     */\n    get composed() {\n        return Boolean(pd(this).event.composed)\n    },\n\n    /**\n     * The unix time of this event.\n     * @type {number}\n     */\n    get timeStamp() {\n        return pd(this).timeStamp\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     * @deprecated\n     */\n    get srcElement() {\n        return pd(this).eventTarget\n    },\n\n    /**\n     * The flag to stop event bubbling.\n     * @type {boolean}\n     * @deprecated\n     */\n    get cancelBubble() {\n        return pd(this).stopped\n    },\n    set cancelBubble(value) {\n        if (!value) {\n            return\n        }\n        const data = pd(this);\n\n        data.stopped = true;\n        if (typeof data.event.cancelBubble === \"boolean\") {\n            data.event.cancelBubble = true;\n        }\n    },\n\n    /**\n     * The flag to indicate cancellation state.\n     * @type {boolean}\n     * @deprecated\n     */\n    get returnValue() {\n        return !pd(this).canceled\n    },\n    set returnValue(value) {\n        if (!value) {\n            setCancelFlag(pd(this));\n        }\n    },\n\n    /**\n     * Initialize this event object. But do nothing under event dispatching.\n     * @param {string} type The event type.\n     * @param {boolean} [bubbles=false] The flag to be possible to bubble up.\n     * @param {boolean} [cancelable=false] The flag to be possible to cancel.\n     * @deprecated\n     */\n    initEvent() {\n        // Do nothing.\n    },\n};\n\n// `constructor` is not enumerable.\nObject.defineProperty(Event.prototype, \"constructor\", {\n    value: Event,\n    configurable: true,\n    writable: true,\n});\n\n// Ensure `event instanceof window.Event` is `true`.\nif (typeof window !== \"undefined\" && typeof window.Event !== \"undefined\") {\n    Object.setPrototypeOf(Event.prototype, window.Event.prototype);\n\n    // Make association for wrappers.\n    wrappers.set(window.Event.prototype, Event);\n}\n\n/**\n * Get the property descriptor to redirect a given property.\n * @param {string} key Property name to define property descriptor.\n * @returns {PropertyDescriptor} The property descriptor to redirect the property.\n * @private\n */\nfunction defineRedirectDescriptor(key) {\n    return {\n        get() {\n            return pd(this).event[key]\n        },\n        set(value) {\n            pd(this).event[key] = value;\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Get the property descriptor to call a given method property.\n * @param {string} key Property name to define property descriptor.\n * @returns {PropertyDescriptor} The property descriptor to call the method property.\n * @private\n */\nfunction defineCallDescriptor(key) {\n    return {\n        value() {\n            const event = pd(this).event;\n            return event[key].apply(event, arguments)\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Define new wrapper class.\n * @param {Function} BaseEvent The base wrapper class.\n * @param {Object} proto The prototype of the original event.\n * @returns {Function} The defined wrapper class.\n * @private\n */\nfunction defineWrapper(BaseEvent, proto) {\n    const keys = Object.keys(proto);\n    if (keys.length === 0) {\n        return BaseEvent\n    }\n\n    /** CustomEvent */\n    function CustomEvent(eventTarget, event) {\n        BaseEvent.call(this, eventTarget, event);\n    }\n\n    CustomEvent.prototype = Object.create(BaseEvent.prototype, {\n        constructor: { value: CustomEvent, configurable: true, writable: true },\n    });\n\n    // Define accessors.\n    for (let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        if (!(key in BaseEvent.prototype)) {\n            const descriptor = Object.getOwnPropertyDescriptor(proto, key);\n            const isFunc = typeof descriptor.value === \"function\";\n            Object.defineProperty(\n                CustomEvent.prototype,\n                key,\n                isFunc\n                    ? defineCallDescriptor(key)\n                    : defineRedirectDescriptor(key)\n            );\n        }\n    }\n\n    return CustomEvent\n}\n\n/**\n * Get the wrapper class of a given prototype.\n * @param {Object} proto The prototype of the original event to get its wrapper.\n * @returns {Function} The wrapper class.\n * @private\n */\nfunction getWrapper(proto) {\n    if (proto == null || proto === Object.prototype) {\n        return Event\n    }\n\n    let wrapper = wrappers.get(proto);\n    if (wrapper == null) {\n        wrapper = defineWrapper(getWrapper(Object.getPrototypeOf(proto)), proto);\n        wrappers.set(proto, wrapper);\n    }\n    return wrapper\n}\n\n/**\n * Wrap a given event to management a dispatching.\n * @param {EventTarget} eventTarget The event target of this dispatching.\n * @param {Object} event The event to wrap.\n * @returns {Event} The wrapper instance.\n * @private\n */\nfunction wrapEvent(eventTarget, event) {\n    const Wrapper = getWrapper(Object.getPrototypeOf(event));\n    return new Wrapper(eventTarget, event)\n}\n\n/**\n * Get the immediateStopped flag of a given event.\n * @param {Event} event The event to get.\n * @returns {boolean} The flag to stop propagation immediately.\n * @private\n */\nfunction isStopped(event) {\n    return pd(event).immediateStopped\n}\n\n/**\n * Set the current event phase of a given event.\n * @param {Event} event The event to set current target.\n * @param {number} eventPhase New event phase.\n * @returns {void}\n * @private\n */\nfunction setEventPhase(event, eventPhase) {\n    pd(event).eventPhase = eventPhase;\n}\n\n/**\n * Set the current target of a given event.\n * @param {Event} event The event to set current target.\n * @param {EventTarget|null} currentTarget New current target.\n * @returns {void}\n * @private\n */\nfunction setCurrentTarget(event, currentTarget) {\n    pd(event).currentTarget = currentTarget;\n}\n\n/**\n * Set a passive listener of a given event.\n * @param {Event} event The event to set current target.\n * @param {Function|null} passiveListener New passive listener.\n * @returns {void}\n * @private\n */\nfunction setPassiveListener(event, passiveListener) {\n    pd(event).passiveListener = passiveListener;\n}\n\n/**\n * @typedef {object} ListenerNode\n * @property {Function} listener\n * @property {1|2|3} listenerType\n * @property {boolean} passive\n * @property {boolean} once\n * @property {ListenerNode|null} next\n * @private\n */\n\n/**\n * @type {WeakMap<object, Map<string, ListenerNode>>}\n * @private\n */\nconst listenersMap = new WeakMap();\n\n// Listener types\nconst CAPTURE = 1;\nconst BUBBLE = 2;\nconst ATTRIBUTE = 3;\n\n/**\n * Check whether a given value is an object or not.\n * @param {any} x The value to check.\n * @returns {boolean} `true` if the value is an object.\n */\nfunction isObject(x) {\n    return x !== null && typeof x === \"object\" //eslint-disable-line no-restricted-syntax\n}\n\n/**\n * Get listeners.\n * @param {EventTarget} eventTarget The event target to get.\n * @returns {Map<string, ListenerNode>} The listeners.\n * @private\n */\nfunction getListeners(eventTarget) {\n    const listeners = listenersMap.get(eventTarget);\n    if (listeners == null) {\n        throw new TypeError(\n            \"'this' is expected an EventTarget object, but got another value.\"\n        )\n    }\n    return listeners\n}\n\n/**\n * Get the property descriptor for the event attribute of a given event.\n * @param {string} eventName The event name to get property descriptor.\n * @returns {PropertyDescriptor} The property descriptor.\n * @private\n */\nfunction defineEventAttributeDescriptor(eventName) {\n    return {\n        get() {\n            const listeners = getListeners(this);\n            let node = listeners.get(eventName);\n            while (node != null) {\n                if (node.listenerType === ATTRIBUTE) {\n                    return node.listener\n                }\n                node = node.next;\n            }\n            return null\n        },\n\n        set(listener) {\n            if (typeof listener !== \"function\" && !isObject(listener)) {\n                listener = null; // eslint-disable-line no-param-reassign\n            }\n            const listeners = getListeners(this);\n\n            // Traverse to the tail while removing old value.\n            let prev = null;\n            let node = listeners.get(eventName);\n            while (node != null) {\n                if (node.listenerType === ATTRIBUTE) {\n                    // Remove old value.\n                    if (prev !== null) {\n                        prev.next = node.next;\n                    } else if (node.next !== null) {\n                        listeners.set(eventName, node.next);\n                    } else {\n                        listeners.delete(eventName);\n                    }\n                } else {\n                    prev = node;\n                }\n\n                node = node.next;\n            }\n\n            // Add new value.\n            if (listener !== null) {\n                const newNode = {\n                    listener,\n                    listenerType: ATTRIBUTE,\n                    passive: false,\n                    once: false,\n                    next: null,\n                };\n                if (prev === null) {\n                    listeners.set(eventName, newNode);\n                } else {\n                    prev.next = newNode;\n                }\n            }\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Define an event attribute (e.g. `eventTarget.onclick`).\n * @param {Object} eventTargetPrototype The event target prototype to define an event attrbite.\n * @param {string} eventName The event name to define.\n * @returns {void}\n */\nfunction defineEventAttribute(eventTargetPrototype, eventName) {\n    Object.defineProperty(\n        eventTargetPrototype,\n        `on${eventName}`,\n        defineEventAttributeDescriptor(eventName)\n    );\n}\n\n/**\n * Define a custom EventTarget with event attributes.\n * @param {string[]} eventNames Event names for event attributes.\n * @returns {EventTarget} The custom EventTarget.\n * @private\n */\nfunction defineCustomEventTarget(eventNames) {\n    /** CustomEventTarget */\n    function CustomEventTarget() {\n        EventTarget.call(this);\n    }\n\n    CustomEventTarget.prototype = Object.create(EventTarget.prototype, {\n        constructor: {\n            value: CustomEventTarget,\n            configurable: true,\n            writable: true,\n        },\n    });\n\n    for (let i = 0; i < eventNames.length; ++i) {\n        defineEventAttribute(CustomEventTarget.prototype, eventNames[i]);\n    }\n\n    return CustomEventTarget\n}\n\n/**\n * EventTarget.\n *\n * - This is constructor if no arguments.\n * - This is a function which returns a CustomEventTarget constructor if there are arguments.\n *\n * For example:\n *\n *     class A extends EventTarget {}\n *     class B extends EventTarget(\"message\") {}\n *     class C extends EventTarget(\"message\", \"error\") {}\n *     class D extends EventTarget([\"message\", \"error\"]) {}\n */\nfunction EventTarget() {\n    /*eslint-disable consistent-return */\n    if (this instanceof EventTarget) {\n        listenersMap.set(this, new Map());\n        return\n    }\n    if (arguments.length === 1 && Array.isArray(arguments[0])) {\n        return defineCustomEventTarget(arguments[0])\n    }\n    if (arguments.length > 0) {\n        const types = new Array(arguments.length);\n        for (let i = 0; i < arguments.length; ++i) {\n            types[i] = arguments[i];\n        }\n        return defineCustomEventTarget(types)\n    }\n    throw new TypeError(\"Cannot call a class as a function\")\n    /*eslint-enable consistent-return */\n}\n\n// Should be enumerable, but class methods are not enumerable.\nEventTarget.prototype = {\n    /**\n     * Add a given listener to this event target.\n     * @param {string} eventName The event name to add.\n     * @param {Function} listener The listener to add.\n     * @param {boolean|{capture?:boolean,passive?:boolean,once?:boolean}} [options] The options for this listener.\n     * @returns {void}\n     */\n    addEventListener(eventName, listener, options) {\n        if (listener == null) {\n            return\n        }\n        if (typeof listener !== \"function\" && !isObject(listener)) {\n            throw new TypeError(\"'listener' should be a function or an object.\")\n        }\n\n        const listeners = getListeners(this);\n        const optionsIsObj = isObject(options);\n        const capture = optionsIsObj\n            ? Boolean(options.capture)\n            : Boolean(options);\n        const listenerType = capture ? CAPTURE : BUBBLE;\n        const newNode = {\n            listener,\n            listenerType,\n            passive: optionsIsObj && Boolean(options.passive),\n            once: optionsIsObj && Boolean(options.once),\n            next: null,\n        };\n\n        // Set it as the first node if the first node is null.\n        let node = listeners.get(eventName);\n        if (node === undefined) {\n            listeners.set(eventName, newNode);\n            return\n        }\n\n        // Traverse to the tail while checking duplication..\n        let prev = null;\n        while (node != null) {\n            if (\n                node.listener === listener &&\n                node.listenerType === listenerType\n            ) {\n                // Should ignore duplication.\n                return\n            }\n            prev = node;\n            node = node.next;\n        }\n\n        // Add it.\n        prev.next = newNode;\n    },\n\n    /**\n     * Remove a given listener from this event target.\n     * @param {string} eventName The event name to remove.\n     * @param {Function} listener The listener to remove.\n     * @param {boolean|{capture?:boolean,passive?:boolean,once?:boolean}} [options] The options for this listener.\n     * @returns {void}\n     */\n    removeEventListener(eventName, listener, options) {\n        if (listener == null) {\n            return\n        }\n\n        const listeners = getListeners(this);\n        const capture = isObject(options)\n            ? Boolean(options.capture)\n            : Boolean(options);\n        const listenerType = capture ? CAPTURE : BUBBLE;\n\n        let prev = null;\n        let node = listeners.get(eventName);\n        while (node != null) {\n            if (\n                node.listener === listener &&\n                node.listenerType === listenerType\n            ) {\n                if (prev !== null) {\n                    prev.next = node.next;\n                } else if (node.next !== null) {\n                    listeners.set(eventName, node.next);\n                } else {\n                    listeners.delete(eventName);\n                }\n                return\n            }\n\n            prev = node;\n            node = node.next;\n        }\n    },\n\n    /**\n     * Dispatch a given event.\n     * @param {Event|{type:string}} event The event to dispatch.\n     * @returns {boolean} `false` if canceled.\n     */\n    dispatchEvent(event) {\n        if (event == null || typeof event.type !== \"string\") {\n            throw new TypeError('\"event.type\" should be a string.')\n        }\n\n        // If listeners aren't registered, terminate.\n        const listeners = getListeners(this);\n        const eventName = event.type;\n        let node = listeners.get(eventName);\n        if (node == null) {\n            return true\n        }\n\n        // Since we cannot rewrite several properties, so wrap object.\n        const wrappedEvent = wrapEvent(this, event);\n\n        // This doesn't process capturing phase and bubbling phase.\n        // This isn't participating in a tree.\n        let prev = null;\n        while (node != null) {\n            // Remove this listener if it's once\n            if (node.once) {\n                if (prev !== null) {\n                    prev.next = node.next;\n                } else if (node.next !== null) {\n                    listeners.set(eventName, node.next);\n                } else {\n                    listeners.delete(eventName);\n                }\n            } else {\n                prev = node;\n            }\n\n            // Call this listener\n            setPassiveListener(\n                wrappedEvent,\n                node.passive ? node.listener : null\n            );\n            if (typeof node.listener === \"function\") {\n                try {\n                    node.listener.call(this, wrappedEvent);\n                } catch (err) {\n                    if (\n                        typeof console !== \"undefined\" &&\n                        typeof console.error === \"function\"\n                    ) {\n                        console.error(err);\n                    }\n                }\n            } else if (\n                node.listenerType !== ATTRIBUTE &&\n                typeof node.listener.handleEvent === \"function\"\n            ) {\n                node.listener.handleEvent(wrappedEvent);\n            }\n\n            // Break if `event.stopImmediatePropagation` was called.\n            if (isStopped(wrappedEvent)) {\n                break\n            }\n\n            node = node.next;\n        }\n        setPassiveListener(wrappedEvent, null);\n        setEventPhase(wrappedEvent, 0);\n        setCurrentTarget(wrappedEvent, null);\n\n        return !wrappedEvent.defaultPrevented\n    },\n};\n\n// `constructor` is not enumerable.\nObject.defineProperty(EventTarget.prototype, \"constructor\", {\n    value: EventTarget,\n    configurable: true,\n    writable: true,\n});\n\n// Ensure `eventTarget instanceof window.EventTarget` is `true`.\nif (\n    typeof window !== \"undefined\" &&\n    typeof window.EventTarget !== \"undefined\"\n) {\n    Object.setPrototypeOf(EventTarget.prototype, window.EventTarget.prototype);\n}\n\nexports.defineEventAttribute = defineEventAttribute;\nexports.EventTarget = EventTarget;\nexports.default = EventTarget;\n\nmodule.exports = EventTarget\nmodule.exports.EventTarget = module.exports[\"default\"] = EventTarget\nmodule.exports.defineEventAttribute = defineEventAttribute\n//# sourceMappingURL=event-target-shim.js.map\n","import naja from 'naja';\n\nimport DependentSelectBox from './DependentSelectBox';\n\nnaja.registerExtension(new DependentSelectBox());\n\ndocument.addEventListener('DOMContentLoaded', naja.initialize.bind(naja));\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}