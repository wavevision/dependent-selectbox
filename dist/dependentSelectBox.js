!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DependentSelectBox",[],t):"object"==typeof exports?exports.DependentSelectBox=t():e.DependentSelectBox=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return f}));var r="data-dependent-data-link",o="data-has-dependent-listener",i="data-parents",u="data-dependent-select-box",a="dependentSelectBoxLoaded",c="dependentSelectBoxLoading",f="["+u+"]"},function(e,t,n){"use strict";var r=n(0),o=function(e){if("checkbox"===e.type)return e.checked;var t=e.value.trim();if(""===t)return null;var n=Number(t);return Number.isNaN(n)?t:n},i=function(e){var t=e.getAttribute(r.b);return t?JSON.parse(t):[]},u=function(e,t){for(var n={},r=0,i=t;r<i.length;r++){var u=i[r],a=e.elements.namedItem(u);a&&(n[a.name]=o(a))}return n},a=function(e){return null!==e.getAttribute(r.c)},c=function(e){return e.setAttribute(r.c,"true")},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=function(e){var t=this;this.handleResponse=function(e,n,o){for(var i in o){var u=document.getElementById(i);u&&null!==u.getAttribute(r.d)&&(u.disabled=o[i].disabled,u.innerHTML=o[i].options)}var a={form:e,dependentSelectBoxes:n,response:o};t.naja.fireEvent(r.e,a)},this.handleRequest=function(e,n,o){return f(t,void 0,Promise,(function(){var t,i,u;return d(this,(function(a){switch(a.label){case 0:if(!(t=e.getAttribute(r.a)))throw new Error('Form "'+e.id+'" must have "data-dependent-data-link" attribute!');return i={data:o,form:e,dependentSelectBoxes:n},this.naja.fireEvent(r.f,i),[4,this.naja.makeRequest("POST",t,o,{dataType:"json",history:!1,responseType:"json"})];case 1:return u=a.sent(),this.handleResponse(e,n,u),[2]}}))}))},this.naja=e},l=function(e){var t=this;this.addListeners=function(e,n,r){var o=["change"];t.isParentTextBased(e)&&o.push("keydown"),o.forEach((function(o){return e.addEventListener(o,t.handleChange(n,r))})),c(e)},this.findParent=function(e){return document.getElementById(e)},this.findSelectBoxes=function(){return Array.from(document.querySelectorAll(r.g))},this.handleChange=function(e,n){return function(r){for(var o=r.target,a=o.form,c=0,f=n;c<f.length;c++){var d=f[c],s=i(d);d.disabled=s.includes(o.id)}t.requestManager.handleRequest(a,t.getFormSelectBoxes(a,n),{trigger:o.id,values:u(a,e)})}},this.getFormSelectBoxes=function(e,t){return t.filter((function(t){return t.form===e}))},this.isParentTextBased=function(e){return["text","number","textarea"].includes(e.type)},this.requestManager=new s(e)},p=function(e){var t=this;this.init=function(){for(var e=t.domManager.findSelectBoxes(),n=0,r=e;n<r.length;n++){var o=r[n],u=i(o);u.forEach(t.initParent(u,e))}},this.initParent=function(e,n){return function(r){var o=t.domManager.findParent(r);null===o||a(o)||t.domManager.addListeners(o,e,n)}},this.naja=e,this.domManager=new l(this.naja),this.naja.addEventListener("load",this.init)};t.a=p},,function(e,t){},,,function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(0);n.d(t,"DATA_LINK",(function(){return o.a})),n.d(t,"DATA_PARENT_LISTENER",(function(){return o.c})),n.d(t,"DATA_PARENTS",(function(){return o.b})),n.d(t,"DATA_SELECT_BOX",(function(){return o.d})),n.d(t,"EVENT_LOADED",(function(){return o.e})),n.d(t,"EVENT_LOADING",(function(){return o.f})),n.d(t,"SELECT_BOX_SELECTOR",(function(){return o.g}));var i=n(3);for(var u in i)["DATA_LINK","DATA_PARENT_LISTENER","DATA_PARENTS","DATA_SELECT_BOX","EVENT_LOADED","EVENT_LOADING","SELECT_BOX_SELECTOR","default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(u);t.default=r.a}]).default}));
//# sourceMappingURL=dependentSelectBox.js.map